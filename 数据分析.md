# 一、数据分析

## 1.1 matplotlib

- 能将数据进行可视化，更直观的呈现
- 使数据更加客观、更具说服力

###  1.1.1 什么是matplotlib

- 最流行的python底层绘图库，主要做数据可视化图表，名字取材于MATLAB，模仿MATLAB构建

### 1.1.2 基本要点

axis轴，指的的是x或者y坐标轴

```python
from matplotlib import pyplot as plt
#figure图形图标的意思，即指画的图
#通过实例化一个figure并且传递参数，能够在后台自动使用该figure实例
#在图像模糊的时候可以传入dpi参数，让图片更加清晰
fig = plt.figure(figsize=(10,4),dpi=80)
x = range(2,26,2)
y = [15,13,14.5,17,20,25,26,26,27,22,18,15]
plt.plot(x,y)
#保存为svg这种矢量图格式，放大不会有锯齿
plt.savefig("./sig_size.png")
plt.show()
```

假设一天中每隔两个小时（range(2,26,2))的气温(℃)分别是[15,13,14.5,17,20,25,26,26,27,22,18,15]

```python 
from matplotlib import pyplot as plt
import random

plt.rcParams['font.sans-serif']=['Kaiti']    #指定默认字体 SimHei为黑体
plt.rcParams['axes.unicode_minus']=False
fig = plt.figure(figsize=(20,8),dpi=100)
y = [random.randint(20,35) for i in range(120)]
x = range(0,120)
plt.plot(x,y)

#设置刻度
_xtricks_labels = ['10点%d分'% i for i in range(60)]
_xtricks_labels += [f'11点{i}分' for i in range(60)]

#取步长、数字和字符串一一对应，数据的长度一样；rotation标签旋转多少度
plt.xticks(list(x)[::8],_xtricks_labels[::8],rotation=45)

#添加描述信息
plt.xlabel("时间")
plt.ylabel("温度 单位：℃")
plt.title("10点到12点每分钟的气温变化情况")
plt.yticks(range(min(y),max(y)+1))

plt.show()
```

11岁到30岁交的朋友数量

a = [1,0,1,1,2,4,3,2,3,4,4,5,6,5,4,3,3,1,1,1]

```python
from matplotlib import pyplot as plt

x = list(range(11,31))
y = [1,0,1,1,2,4,3,2,3,4,4,5,6,5,4,3,3,1,1,1]

plt.plot(x,y)

plt.show()
```

```p
from matplotlib import pyplot as plt

plt.figure(figsize=(20,8),dpi=80)
x = list(range(11,31))
y_1 = [1,0,1,1,2,4,3,2,3,4,4,5,6,5,4,3,3,1,1,1]
y_2 = [1,0,3,1,2,2,3,3,2,1,2,1,1,1,1,1,1,1,1,1]
plt.plot(x,y_1, label="自己", color="red", linestyle="-", linewidth=2)   #- 实线、-. 点划线, : 虚线， -- 划线
plt.plot(x,y_2, label="同桌", color="cyan", linestyle="-.")

plt.xticks(x)
plt.yticks(range(min(min(y_1),min(y_2)),max(max(y_1),max(y_2))+1))

plt.xlabel("年龄")
plt.ylabel("女朋友个数 单位：个")

#绘制网格
plt.grid(alpha=0.4, axis="y")  #alpha透明度

#添加图例
plt.legend(loc="upper left")  #"best", "lower right" ...

plt.savefig("./girlfriends.png")

plt.show()
```

```python
from matplotlib import pyplot as plt
import matplotlib
import random
from matplotlib import font_manager

plt.rcParams['font.sans-serif']=['Kaiti']    #指定默认字体 SimHei为黑体
plt.rcParams['axes.unicode_minus']=False

fig = plt.figure(figsize=(20,8),dpi=100)
y = [random.randint(20,35) for i in range(120)]
x = range(0,120)
plt.plot(x,y)

#设置刻度
_xtricks_labels = ['10点%d分'% i for i in range(60)]
_xtricks_labels += [f'11点{i}分' for i in range(60)]

#取步长、数字和字符串一一对应，数据的长度一样；rotation标签旋转多少度
plt.xticks(list(x)[::8],_xtricks_labels[::8],rotation=45)

#添加描述信息
plt.xlabel("时间")
plt.ylabel("温度 单位：℃")
plt.title("10点到12点每分钟的气温变化情况")
plt.yticks(range(min(y),max(y)+1))

plt.show()
```

```python
#randn数组
import numpy as np

np.random.seed(19680801)
L1 = np.random.randn(3,3)
np.random.seed(19680801)
L2 = np.random.randn(3,3)
print(L1)
print(L2)
```

```python
#横条形图
import random
from matplotlib import pyplot as plt


plt.rcParams['font.sans-serif']=['Kaiti']    #指定默认字体 SimHei为黑体
plt.rcParams['axes.unicode_minus']=False

plt.figure(figsize=(20,8), dpi=80)
a = ['肖申克的救赎', '霸王别姬', '阿甘正传', '美丽人生', '辛德勒的名单', '泰坦尼克号', '盗梦空间', '星际穿越', '控方证人', '忠犬八公的故事', '楚门的世界', '海上钢琴师', '疯狂动物城', '无间道', '放牛班的春天', '触不可及', '机器人总动员', '三傻大闹宝莱坞', '末代皇帝', '当幸福来敲门']
b = [round(random.randint(2,30)*random.random()*10, 2)  for i in range(20)]
#b = b.sort(reverse=True)
plt.barh(range(len(a)), b, height=0.5)   #barh即可表示横条形图

plt.yticks(range(len(a)), a, fontsize=15)
plt.xticks(range(0,200,10))

plt.ylabel("电影名称", fontsize=30)
plt.xlabel("票房", fontsize=30)

#绘制网格
plt.grid(alpha=0.4)

plt.savefig('./movie.png')
plt.show()
```

```python
# 竖条形图
import random
from 

plt.figure(figsize=(20,8), dpi=80)
a = ['肖申克的救赎', '霸王别姬', '阿甘正传', '美丽人生', '辛德勒的名单', '泰坦尼克号', '盗梦空间', '星际穿越', '控方证人', '忠犬八公的故事', '楚门的世界', '海上钢琴师', '疯狂动物城', '无间道', '放牛班的春天', '触不可及', '机器人总动员', '三傻大闹宝莱坞', '末代皇帝', '当幸福来敲门']
b = [round(random.randint(2,30)*random.random()*10, 2)  for i in range(20)]
#b = b.sort(reverse=True)
plt.bar(range(len(a)), b, width=0.5)

plt.xticks(range(len(a)), a, rotation=45, fontsize=15)

plt.xlabel("电影名称", fontsize=30)
plt.ylabel("票房", fontsize=30)

plt.savefig('./movie.png')
plt.show()
```

```python
#条形图组


a = ['肖申克的救赎', '霸王别姬', '阿甘正传', '美丽人生']
b_16 = [3.14,7.15,18.02,31.00]
b_15 = [5.41,6.32,13.56,2.01]
b_14 = [1.11,2.22,3.33,4.44]

plt.figure(figsize=(20,8), dpi=80)

bar_width = 0.2

x_14 = list(range(len(a)))
x_15 = [i+bar_width for i in x_14]
x_16 = [i+bar_width*2 for i in x_14]

plt.bar(x_14, b_14, width=bar_width, label="9月14日", color="red")
plt.bar(x_15, b_15, width=bar_width, label="9月15日")
plt.bar(x_16, b_16, width=bar_width, label="9月16日")

plt.xticks(x_14,a)
plt.xticks(x_15,a)
plt.xticks(x_16,a)

plt.legend(loc="best")
plt.show()
```

```python
#绘制饼图
def pie(x, explode=None, labels=None, colors=None, autopct=None,

pctdistance=0.6, shadow=False, labeldistance=1.1, startangle=None,

radius=None, counterclock=True, wedgeprops=None, textprops=None,

center=(0, 0), frame=False, rotatelabels=False, hold=None, data=None)

pie 函数参数详解，英文原版请参见：matplotlib官网pie函数：

x :(每一块)的比例，如果sum(x) >1会使用sum(x)归一化；

labels :(每一块)饼图外侧显示的说明文字；

explode :(每一块)离开中心距离；

startangle :起始绘制角度,默认图是从x轴正方向逆时针画起,如设定=90则从y轴正方向画起；

shadow :在饼图下面画一个阴影。默认值：False，即不画阴影；

labeldistance :label标记的绘制位置,相对于半径的比例，默认值为1.1, 如<1则绘制在饼图内侧；

autopct :控制饼图内百分比设置,可以使用format字符串或者format function'%1.1f'指小数点前后位数(没有用空格补齐)；

pctdistance :类似于labeldistance,指定autopct的位置刻度,默认值为0.6；

radius :控制饼图半径，默认值为1；counterclock：指定指针方向；布尔值，可选参数，默认为：True，即逆时针。将值改为False即可改为顺时针。

wedgeprops：字典类型，可选参数，默认值：None。参数字典传递给wedge对象用来画一个饼图。例如：wedgeprops={'linewidth':3}设置wedge线宽为3。

textprops：设置标签(labels)和比例文字的格式；字典类型，可选参数，默认值为：None。传递给text对象的字典参数。

center：浮点类型的列表，可选参数，默认值：(0,0)。图标中心位置。

frame：布尔类型，可选参数，默认值：False。如果是true，绘制带有表的轴框架。

rotatelabels：布尔类型，可选参数，默认为：False。如果为True，旋转每个label到指定的角度。

import matplotlib.pyplot as plt

plt.rcParams['font.sans-serif']=['Kaiti']    #指定默认字体 SimHei为黑体
plt.rcParams['axes.unicode_minus']=False
# 1）准备数据
movie_name = ['雷神3：诸神黄昏','正义联盟','东方快车谋杀案','寻梦环游记','全球风暴','降魔传','追捕','七十七天','密战','狂兽','其它']

place_count = [60605,54546,45819,28243,13270,9945,7679,6799,6101,4621,20105]

# 2）创建画布
plt.figure(figsize=(20, 8), dpi=100)

# 3）绘制饼图 %.2f%%表示保留两位小数，并百分号显示
plt.pie(place_count, labels=movie_name, autopct="%.2f%%", colors=['b','r','g','y','c','m','y','k','c','g','y'])

# 显示图例
plt.legend(loc="upper right")

# 添加标题
plt.title("电影排片占比")

# 4）显示图像
plt.show()

```

```python
#分布图

from matplotlib import pyplot as plt

#设置一个画布，两行三列，并对齐
#fig 画框，ax(axes)区域
fig, ax = plt.subplots(2,3,sharex="col",sharey="row")

#将选定行列粘合到一起
grid = plt.GridSpec(2,3,wspace=0.1,hspace=0.1)

plt.subplot(grid[0,0])
plt.subplot(grid[0,1:])
plt.subplot(grid[1,0:2])
plt.subplot(grid[1,2])

# plt.subplot(2,2,[2,4])

plt.show()
```

```python
#两个画布图
x = np.arange(1,11)
y1 = np.random.randn(10)
y2 = np.random.randn(10)

fig,(ax1,ax2) = plt.subplots(1,2, sharey=True, figsize=(20,8))

ax1.fill_between(x, y1, color="salmon", alpha=0.4)
ax1.set_title("Simple Area Chart")

ax2.fill_between(x, y2, color="skyblue", alpha=0.4)
ax2.plot(x, y2, color="blue", linewidth=2)
ax2.set_title("Area + Highlight Line")

plt.show()
```

## 1.2 numpy

```python
查看数组的形状
a.shape   

修改数组的形状
a.reshape(3,4)

改为一行
a.flatten()
a = a.reshape((a.shape[0]*a.shape[1],))

数组加减乘除
a = a + 3

nan：not a number
inf: infinite
    
有序数组
a = np.arange(100,124).reshape(4,6)

维度相同数组或行相同或列相同都可以计算

按轴计算，x轴为0，y轴为1，z轴为2

numpy读取数据
np.loadtxt(frame, dtype=np.float, delimiter=None, skiprows=0, usecols=None, unpack=False)

frame:文件、字符串或产生器，可以是.gz或bz2压缩文件
dtype:数据类型，可选，CSV的字符串以什么数据类型读入数组中，默认np.float
delimiter:分隔字符串，默认是任何空格，改为逗号
shiprows:跳过前x行，一般跳过第一行表头
usecols:读取指定的列、索引、元组类型
unpack:如果True，读入属性将分别写入不同数组变量，False读入数据只写入一个数组变量，默认False,即转置效果（a.transpose()、a.T、a.swapaxes(1,0)
    
取多行
a[[2,3,4]]
取列
a[:,1]
a[:,[2,3,4]]

数值的修改
a[a<10]=3
np.where(a<10,0,10) 小于10的改为0，其余的改为10
a.clip(10,18) 小于10的改为10，其余改为18
数值类型转换
a.astype(float)

数组的拼接
np.vstack((t1,t2) 竖拼
np.hstack((t1,t2)) 横拼

获取最大值最小值的位置
np.argmax(a, axis=0)
np.argmin(a, axis=1)

创建一个全为0的数组
np.zeros((3,4))
          
创建一个全为1的数组
np.ones((3,4))

创建一个对角线为1的正方形数组（方阵）
np.eye(3)

rand(d0,d1,..dn):创建d0-dn维度的均匀分布的随机数数组，浮点数，范围0-1
          
randn(d0,d1,..dn):创建d0-d1维度的标准正态分布随机数，浮点数，平均数0，标准差1
          
randint(low,high,(shape)):从给定上下限范围选取随机数整数，范围是low,high，形状是shape

uniform(low,high,(size)):产生具有均匀分布的数组，low起始值，high结束值,形状是size
          
normal(loc,scale,(size)):从指定正态分布中随机抽取样本，分布中心是loc(概率分布的均值)，标准差是scale，形状是size
         
seed(s):随机数种子，s是给定的种子值，因为计算机生成的是伪随机数，所以通过设定相同的随机数种子，可以每次生成相同的随机数
          
copy和view
a = b,完全不复制，a和b相互影响
a = b[:],视图的操作，一种切片，会创建新的对象a，但是a的数据完全由b保管，数据变化是一致的
a = b.copy(),复制，a和b互不影响
          
nan:当读取本地文件为float时，如果有缺失，就会出现nan；当做了一个不合适的计算的时候（比如无穷大（inf)减去无穷大）

inf(-表示负无穷)

两个nan是不相等的
np.nan != np.nan
返回值：True
可以借此判断数组中nan的个数：
np.count_nonzero(t != t)
np.count_nonzero(np.isnan(a))

nan与任何数相加都是nan

求和:a.sum(axis=None)
均值：a.mean(a,axis=None)
中值：np.median(a,axis=None)
最大值：a.max(axis=None)
最小值:a.min(axis=None)
极值:np.ptp(a,axis=None)
标准差:a.std(axis=None)
    
import numpy as np
a = np.arange(50,100).reshape(5,10).astype(float) 
a[1,3:] = np.nan
for i in range(a.shape[1]):
    temp_col = a[:,i]
    nan_num = np.count_nonzero(temp_col != temp_col)
    if nan_num != 0:
        temp_not_nan_col = temp_col[temp_col == temp_col]
        temp_not_nan_col.mean()
        temp_col[np.isnan(temp_col)] = 	temp_not_nan_col.mean()  #对true的值更改
a        
```

## 1.3 pandas

numpy能够处理数值型数据，但仅限于此，pandas能够处理字符串、时间序列等数据

### 1.3.1 Series

```python
import pandas as pd
import string
import numpy as np

t = pd.Series(np.arange(26), index=list(string.ascii_uppercase[:26]))
t

dic = {"name":"duliang", "age":18, "gender":"m"}
t = pd.Series(dic)
t

a = {string.ascii_uppercase[i]: i for i in range(10)}
a

切片和索引
t["name"]
t[0]
t.index
t.values
```

### 1.3.2 DataFrame

```python
t = pd.DataFrame(np.arange(12).reshape(3,4))
行索引：axis=0
列索引：axis=1

s = pd.DataFrame(np.arange(12).reshape(3,4), index=list("abc"), columns=list("wxyz"))
s

s = pd.DataFrame(np.arange(12).reshape(3,4), index=list(string.ascii_lowercase[0:3]), columns=list(string.ascii_uppercase[-4:]))
s

DataFrame的基础属性
df.shape 行数
df.dtype 列数据类型
df.ndim 数据维度
df.index 行索引
df.columns 列索引
df.values 对象值，二维ndarray数组

DataFrame整体情况查询
df.head(3) 显示头部几行，默认5行
df.tail(3) 显示末尾几行，默认5行
df.info 相关信息概览
df.describe() 快速综合统计结果：计数、均值、标准差、最大值、四分位数、最小值

df.sort_values(by="索引名", ascending=False)

df[1:3]  默认取行
df.loc 通过标签索引取
df.iloc 通过位置取

np.random.seed(1)
s = pd.DataFrame(np.random.randint(1,100,size=(8,6)), index=list(string.ascii_lowercase[0:8]), columns=list(string.ascii_uppercase[-6:]))
set(s["W"].tolist())  提取指定行或列做成列表

df.median()
df.argmin()

#双循环，对列表中的列表进行展开
[i for j in a for i in j]
list(np.array(a).flatten())

flatten()  #多维压成一维
```

#### 分类

- 统计分类的列表

```python
temp_list = df["genre"].str.split(",").tolist()  # [[], ..[]]

genre_list = list(set([i for j in temp_list for i in j]))

#构造全为0的数组
zeros_df = pd.DataFrame(np.zeros((df.shape[0],len(genre_list))), columns=genre_list)

#给每个出现分类的位置赋值1
for i in range(df.shape[0]):
    zeros_df.loc[i, temp_list[i]] 

a.join(b) 默认行合并，并以a行为主
a.merge(b, on="", how="outer/left/right/inner") 按on合并,等同MySQL里的join

```



# 二、PlantUML

# 三、mermaid

**flow**

1. 不同的括号
   - （）圆框
   - {}  菱形
   - \[ ]  直角框
   - \> ]  旗框
   - （[ ]）球场型框
   - [( )]  圆柱形
   - [[ ]] 框中框
   - {{ }}  六边形
   - [/  /] 四边形
   - [/  \\]   梯形
2. 连接
   - ---   直线连接     
     - -的多少决定连接的长短
   - -->  实线箭头连接
   - -.->  虚线箭头连接
   - |  |  连接中插入文字    
     - 示例：A --> |hello| B或者-- hello -->
   - ==>  厚连接
   - --x  或者  --o  箭头形状不同
   - <-->  双向箭头
3. 方向
   - TD    从上到下
   - TB    自上而下
   - BT     自下而上
   - LR     从左到右
   - RL     从右到左

# 四、Django

## 基础知识：

**http协议**





## 组件

- 基本配置文件/路由系统
- 模型层（M）/模板曾（T）/视图层（V）
- Cookies和Session
- 分页及发邮件
- Admin管理后台

## 用途

- 网站/微信公众号/小程序后端开发
- 人工智能平台融合

**创建项目**

django-admin startproject 项目名 即可创建出对应项目文件夹

ls 查看项目

**启动服务**

- 相关知识:md 文件夹名    cd.>文件名.格式     del  删除文件



# 五、MATLAB

**快捷键**

| clc                       | 清除command window中所有变量           |
| ------------------------- | -------------------------------------- |
| clear all                 | 清除workspace中的所有变量              |
| ctrl+shift+d              | 统一编辑框                             |
| ctrl+shift+u              | 分开编辑框                             |
| ctrl+shift+m              | 最小化最大化                           |
| %%、%                     | 注释                                   |
| ctrl+r                    | 注释                                   |
| [1 2 3；3 4 5]            | 矩阵                                   |
| a‘                        | 转置                                   |
| a(:）                     | 拉伸                                   |
| inv(a)                    | 逆矩阵                                 |
| zeros(10, 5, 3)           | 10行5列3维的零矩阵                     |
| rand(m, n)                | m行n列                                 |
| randn                     | 标准正态分布                           |
| randi（x）                | (0, x)均匀分布                         |
| randi(imax, m, n)         | 在开区间（0， iMax）生成mXn型随机矩阵  |
| randi([imin, imax], m, n) | 在开区间（imin, imax)生成mXn型随机矩阵 |
| ctrl+g                    | 跳到指定行                             |
| ctrl+f2                   | 添加标签                               |
| shift+f2                  | 跳到标签                               |
| ctrl+c                    | 强制中断                               |
| ctrl+q                    | 强制退出                               |
|                           |                                        |
**编辑器窗口（Editor）下的常用快捷键：**
自动对齐程序（整理缩进）-自动整理代码	用鼠标选中代码行，按Ctrl + I （我一般先 Ctrl+A 全选所有代码，再 Ctrl+I）
快速注释代码段	拖动鼠标选中需要注释的代码行，按Ctrl + R
快速取消注释代码段	拖动鼠标选中已经注释的代码行，按Ctrl + T
撤销改动	Ctrl + Z
取消撤销（撤销过多时使用）	Ctrl + Y
多行代码增加缩进（代码段右移）	选中代码段，按   Tab键   或   Ctrl + ]
多行代码减少缩进（代码段左移）	选中代码段，按   Shift+Tab键   或   Ctrl + [
自动补全命令（记不全函数名时使用）	输入函数的前几个字母，再按Tab
查找或替换变量名、函数名	Ctrl + F
关闭当前的程序文本（.m）文件	Ctrl + W
在Editor窗体中切换	
Ctrl + PageUp/PageDown

Ctrl+PgUp表示编辑器窗口向左切换文件

Ctrl+PgDn表示编辑器窗口向右切换文件
代码调试常用快捷键：

运行	F5可保存并直接运行程序
执行选中代码段	F9
单步执行	F10
F11	表示step in，即当遇见子函数时，使用此快捷键，进入函数内部
Shift + F11	表示step out，即使用此快捷键，执行完子函数的剩余程序，并跳出子函数
设置或取消断点的方法有两种	
(1) 在要设置断点的行左侧的-处单击；

(2) 可按F12设置断点。

直接跳至某行	Ctrl + G， 当程序源代码很长时，可能有几百上千行。有时错误出现在很后面的地方，需要用鼠标中间的滚轮往下滚很久，才能滚到想要的那一行。这时，按Ctrl+G，就会跳出一个对话框，输入想要去的那一行的行号，就可以直接跳过去了。
强制中断程序的运行	Ctrl + C
**命令窗口（Command Window）下的常用快捷键与命令：**
再现历史命令	
上下光标键↑↓   ，在命令窗口中，上下光标键可以调用Matlab最近使用过的历史命令，便于快速重新执行。 如果输入命令的前几个字母，再使用光标键，则只会选择以这些字母开始的命令。 上下箭头寻找此前和此后输入的命令，每次一条。

快速退出MATLAB	Ctrl + Q
清除输入的命令	Esc
将光标处至结尾之间的代码删除	Ctrl + K
what	显示当前工作路径中的所有代码文件
type 代码文件名	显示代码文件的内容
edit	启动编辑器，并新建一个空白文件
edit 代码文件名	打开相应代码文件
whatsnew	列出MATLAB新版本更新的内容
**切换窗口快捷键：**

Ctrl+0	命令行窗口（Command Window）
Ctrl + Shift + 0	编辑器窗口（Editor）
Ctrl + 1	历史命令窗口（Command History）
Ctrl + 2	当前工作窗口（Current Folder）
Ctrl + 3    工作空间（Workspace）

**元胞数组**

A = cell(1, 6)
A{2} = eye(3)
A{5} = magic(5)
B = A{5}

**结构体**

```matlab
books = struct('name', {{'machine learning', 'dara mining'}}, 'price', [30, 40])

books.name    % 属性

books.name(1)   %cell

books.name{1}	%值
```

```matlab
%% 矩阵操作
% 1.矩阵的定义与构建
A = [1 2 3 4 5 6]
B = 1:2:6   % 1到9步长为2
C = repmat(B, 3, 2)  %重复B,竖向重复3次,横向重复2次
D = ones(2, 4)  %两行四列的单位矩阵

%2.矩阵的四则运算
a = [1:1:3; 4:1:6]
b = [1:1:3; 4:1:6]
c = a + b
d = a - b
e = a * b'
f = a .* b    %对应位置相乘
g = a/b     % g * b = a   G * b * pinv(b) = a * pinv(b)  G = a * pinv(b) 相当于a*b的逆矩阵
h = a ./ b
i = pinv(a)   %pinv伪逆矩阵
j = a * i

% 3.矩阵的下标
a = magic(5)
b = a(2, 3)   %矩阵a的第2行第3列
c = a(3, :)   %矩阵a的第3行
d = a(:, 4)   %矩阵a的第4列
[m, n] = find(a > 20)    %找大于20的序号值/矩阵，即第m行第n列的值比20大
```

**循环**

```matlab
sum = 0
for n = 1:5
	sum = sum + n^2
end
```

- 使用for循环求$$ \sum_{i=1}^{5}i!$$

  ```matlab
  sum = 0
  for i = 1:5
  	p = 0
  		for j = 1:i
  			p = p * j
          end
      sum = sum + p
  end
  ```

- while end

- if  	end

- if   else   end

- switch exp

  ​	case 数值或字符串1

  ​		语句体1

     case  数值或字符串2

  ​		语句体2

  otherwise

  ​		语句体3

  end

  

  

  

  

  

  

  

  

  

# 六、VBA和宏

## 6.1 vba语句

- 宏程序语句

  - 运行后可以完成一个功能

  - ```vb
    sub fdsf() `开始语句
        range('a') = 100
    end sub
    ```

- 函数程序语句

  - 运行后可以返回一个值

  - ```vb
    function shcount()
        shcuont = sheets.count
    end function 
    ```

- 在程序中应用的语句

  - ```vb
    sub test()
        call test
    end sub  
    ```

  - ```vb
    sub test2()
        for x = 1 to 100
        	cells(x,1) = x
    	next x
    end sub
    ```

## 6.2 vba对象

- 就是操作的具体方法、属性的excel中支持的对象

- 常用对象表示方法：

  - 系统
     - application代表正在运行的excel系统本身

     - ```vb
       application.worksheetfunction.公式名称  '能够直接调用excel表格公式
       application.displayalerts = False '不显示警告框
       '操作完成后再重新设置为true
       application.quit  '退出
       ```

  - 工作簿
     - workbooks代表工作簿集合，所有的工作簿；workbooks(N)表示已打开的第N个工作簿

     - workbooks工作簿名称

     - activeworkbook正在操作的工作簿

       - ```vb
         application.activeworkbook   
         ```

     - thisworkbook代码所在的工作簿

  - 工作表
     - sheets工作表名称

     - sheet1表示第一个插入的工作表

     - sheets(n)表示安排列顺序，第n个工作表

     - ActiveSheet表示活动工作表，光标所在工作表

       - ```vb
         application.activesheet
         sub 活动工作簿示例()
             dim w_1 as workbook, w_2 as workbook
             
             set w_1 = application.activesheet
             set w_2 = workbooks.add
             w_1.worksheets(1).cells(2, 3) = "hello"
             w_2.worksheets(1).cells(2, 3) = "how are you"
         end sub
         ```

     - worksheet也表示工作表，但不包括图标工作表、宏工作表

  - 单元格
     - cells所有单元格
     - range单元格地址
     - cells行数、列数
     - activecell正在选中或编辑的单元格
     - selection正被选中或选取的单元格或单元格区域

     

     

     

- ```vb
  Sub test()
      Dim w_1 As Worksheet
      Set w_1 = Worksheets(1)     '为代表对象的变量赋值时，必须使用set关键字
      w_1.Cells(5, 3) = "人在江湖，身不由己"
  End Sub
  
  worksheets.add 添加新工作表
  worksheets.count 总工作表数
  
  ```

- ```vb
  '最好用名字代替工作表序号
  '排除不需要的表
  worksheet.Name <> "指定表"
  Private Sub CommandButton1_Click()
      Dim w_1, w_2 As Worksheet
      Dim i, j, s
      Set w_2 = Worksheets(1)
      w_2.Cells(1, 1) = "姓名"
      w_2.Cells(1, 2) = "总分"
      For i = 2 To 4
          s = 0
          Set w_1 = Worksheets(i)
          For j = 2 To 5
              s = s + w_1.Cells(j, 2)
          Next j
          w_1.Cells(2, 3) = s
          '姓名
          w_2.Cells(i, 1) = w_1.Cells(1, 2)
          '对应的总分
          w_2.Cells(i, 2) = s
      Next i
  
  End Sub
  ```

- ```vb
  '过程
  call **
  '也可以省略call，直接写程序名
  ```

- ```vb
  Private Sub CommandButton2_Click()
      暴力倾向分析
  End Sub
  
  Sub 暴力倾向分析()
      Dim i, score, level
      
      i = 12
      
      Do While Cells(i, 1) <> ""
          score = Cells(i, 2)
          level = 客户分类(score)
          Cells(i, 3) = level
          i = i + 1
      Loop
      
  End Sub
  
  
  Function 客户分类(s)
      Dim score, level
      
      score = s
      If score < 30 Then
          level = "温柔型"
      ElseIf score < 60 Then
          level = "冲动型"
      ElseIf score < 90 Then
          level = "暴躁型"
      Else
          level = "狂暴型"
      End If
      客户分类 = level
  End Function
  
  ```

- ```vb
  dim r as range
  set r = range()
  range("c2:c5")
  range("c2:c5, d4:d9")
  range(cells(2, 3), cells(5, 7))
  r.clear   '清除全部（内容和格式）
  r.clearcontents  '清除内容，保留格式（字体颜色等）
  r.clearformats   '清除格式
  r.font   '修改字体
      r.font.size = 18
      r.font.color = rgb(255, 0, 0)
      r.font.italic = ture '是否为斜体
      r.font.bold  = false  '是否粗体
      r.interior.color = rgb(0, 255, 0) '单元格颜色
      r.interior.pattern '
      r.merge
      r.unmerge
  '简化操作
      with r.font
      	.size = 15
      	.color = rgb(255, 0, 0)
      	.bold = true
      	.italic = true
  	end with
  ```

## 6.3 vba属性

- 就是vba对象所具有的特点

  

- 表示某个对象的属性的方法是：

  - 对象.属性 = 属性值

  - ```vb
    sub ttt()
        range("a1").value = 100
    end sub
    ```

  - ```vb
    sub ttt()
        sheets(1).name = "工作表改名了"
    end sub
    ```

  - ```vb
    sub ttt2()
        sheets("sheet2").range("a1").value = "abcd"
    end sub
    ```

  - ```vb
    sub ttt3()
        range("A2").interior.colorindex = 3 #单元格填充颜色
        rnage("a2").font.colorindex = 3 #字体颜色
    end sub
    ```

## 6.4 vba方法

- 是作用于vba对象上的动作

- 表示用某个方法作用于vba的对象上，可以用下面的格式：

  - 对象.方法 参数名称 := 参数值

  - ```vb
    sub ttt4()
        range("a1").copy destination := range("a2")
        range("A1").copy range("a2")
    end sub
    ```

  - ```vb
    sub 判断1()
        if range("a1").value > 0 then 
            range("b1") = "正数"
        else
            range("b1") = "负数或0"
        end if
    end sub
    ```

  - ```vb
    sub 判断2()
        if range("a1").value > 0 then
            range("b1") = "正数"
        elseif range("a1") = 0 then
            range("b1") = "等于0"
        else
            range("b1") = "负数"
        end if
    end sub
    ```

  - ```vb
    sub 判断3()
        if range("a3") < "G" then
            msgbox "A-G"
        end if
    end sub
    ```

  - ```vb
    sub 判断2()
        select case range("a1").value
        case is > 0
            range("b1") = "正数"
        case is = 0
            range("b1") = "0"
        case else
            range("b1") = "负数"
        end select
    end sub
    ```

  - ```vb
    sub 判断4()
        range("a3") = iff(range("a1") <= 0, "负数或零", "负数")
    end sub
    ```

  - ```vb
    sub if区间判断()
            if range("a1") <= 1000 then
                range("b2") = 0.01
            elseif range("a1") <= 3000 then
                range("b2") = 0.03
            elseif range("a1") > 3000 then
                range("b2") = 0.05
            end if
        end sub
    ```

  - ```vb
    sub select区间判断()
            select case range("a1").value
            case 0 to 1000
                range("b2") = 0.01
            case 1001 to 3000
                range("b2") = 0.03
            case is > 3000
                range("b2") = 0.05
            end select
            
    ```

  - ```vb
    sub t()
        dim x as integer
        for x = 1 to 1000 step 1 'step可正可负
        	range("d"&x) = range("b"&x) * range("c"&x)
    	next x 
    end sub
    ```

  - ```vb
    sub t2()
        dim rg as range
        for each rg in range("d2:d18")
        	rg = rg.offset(0,-1) * rg.offset(0,-2)
    	next rg
    end sub
    ```

  - ```vb
    sub s1()
        dim rgg as range
        for each rgg in range("a1:b7,d5:e9")
        if rgg = "" then 
            rgg = 0
        end if
    next rgg
    end sub
    ```

  - ```vb
    Sub s2()
        Dim x As Integer
        Do
            x = x + 1
            If Cells(x + 1, 1) <> Cells(x, 1) + 1 Then
                Cells(x, 2) = "断点"
                Exit Do   
        End If
        Loop Until x = 14
    End Sub
    ```

  - ```vb
    Sub s4()
     Dim x As Integer
     x = 1
     Do
      x = x + 1
      Cells(x, 4) = Cells(x, 2) * Cells(x, 3)
     Loop Until x = 20
    End Sub
    ```

  - ```vb
    Sub s5()
     x = 1
     Do While x < 18
      x = x + 1
      Cells(x, 4) = Cells(x, 2) * Cells(x, 3)
     Loop
    End Sub
    ```

## 6.4 变量的声明和使用

- 强制声明

```vb
option explicit
dim s, r, v  '此时只能使用这三个变量
```

- 常量

  ```vb
  const pi = 3.1415926  'pi固定成常量，不可再次赋值，如税率等
  =column() '显示第几列
  ```

- 优先级

  ```vb
  not -> and -> or  '没有括号时先not后and
  ```

  

- 

- 可以放数字、对象、数组、文本

  - ```vb
    '放数组
    sub arr()
        dim arr(1 to 10) as integer ,x as integer
        for x = 1 to 10
            arr(x) = x
    next x
    end sub
        
    ```

  - ```vb
    '放对象
    sub obj()
        dim rg as range
        set rg = range("a1")
            rg = 100
    end sub
    ```

  - ```vb
    public '声明一个全局变量'
    ```

## 6.5 公式与函数

- 在单元格中输入公式

  - 普通公式

    - ```vb
      sub t1()
          range("d2") = "=b2*c2"
      end sub
      ```

    - ```vb
      sub t2()
          dim x as integer
          for x = 2 to 6
          cells(x,4) = "=b" & x & "*c" & x
      next x
      end sub
      ```

  - 带引号的公式

    - ```vb
      '统计物品中b的数量和
      sub t3()
          range("c9") = "=sumif(A2:A6,""b"",B2:B6)" '遇到双引号就把双引号加倍
      end sub
      ```

  - 数组公式

    - ```vb
      sub t4()
          range("c9").formulaarray = "=sum(B2:B6*C2:C6)"
      end sub
      ```

- 利用单元格返回值

  - ```vb
    sub t5()
       range("d13")=evaluate("=sumif(A2:A6,""b"",B2:B6)")
        range("d9") = evaluate("=sum(B2:B6*C2:C6)")
    end sub
    ```

- 借用工作表函数

  - ```vb
    sub t6()
        range("d8") = application.worksheetfunction sum(range("d2:d6")) '调用时必须用range
    end sub
    ```

- 利用vba函数

  - ```vb
    sub t7()
        range("C20") = vba.instr(range("a20"),"e")
    ```

- 编写自定义函数

  - ```vb
    function wn()
        wn = appliton.caller.parent.name
    end function
    ```

### 1. 测试函数

```vb
IsNumeric(x) '是否为数字, 返回Boolean结果，True or False
比isnumber更准确

IsDate(x) '是否是日期, 返回Boolean结果，True or False
if isdate() then

IsEmpty(x) '是否为Empty, 返回Boolean结果，True or False

IsArray(x) '指出变量是否为一个数组。

IsError(expression) '指出表达式是否为一个错误值

IsNull(expression) '指出表达式是否不包含任何有效数据 (Null)。

IsObject(identifier)'指出标识符是否表示对象变量
    
typename(x) '返回数据的类型
```

### 1.2 数学函数

```vb
Sin(X)、Cos(X)、Tan(X)、Atan(x) '三角函数，单位为弧度

Log(x) '返回x的自然对数

Exp(x)'返回 ex

Abs(x) '返回绝对值

Int(number)、Fix(number) '都返回参数的整数部分，区别：Int 将 -8.4 转换成 -9，而 Fix 将-8.4 转换成 -8

Sgn(number) '返回一个 Variant (Integer)，指出参数的正负号

Sqr(number) '返回一个 Double，指定参数的平方根

VarType(varname) '返回一个 Integer，指出变量的子类型

Rnd（x）'返回0-1之间的单精度数据，x为随机种子
```

### 1.3 字符串函数

```vb
Trim(string) '去掉string左右两端空白

Ltrim(string) '去掉string左端空白

Rtrim(string) '去掉string右端空白

Len(string) '计算string长度

Left(string, x) '取string左段x个字符组成的字符串

Right(string, x) '取string右段x个字符组成的字符串

Mid(string, start,x) '取string从start位开始的x个字符组成的字符串

Ucase(string) '转换为大写

Lcase(string) '转换为小写

Space(x) '返回x个空白的字符串

replace(s, a, b) '用b替换a

Asc(string) '返回一个 integer，代表字符串中首字母的字符代码

Chr(charcode) '返回 string,其中包含有与指定的字符代码相关的字符

instr(i, s, a) '在s中寻找a,返回a的位置,从哪个字符开始找’

instrrev  从最右开始寻找

& chr(13) & chr(10) & '换行符
'遍历字母
Sub chrdemo()
    Dim i%
    For i = 65 To 90
        Cells(i - 64, 1) = Chr(i)
    Next i
End Sub
```

### 1.4 转换函数

```vb
CBool(expression) '转换为Boolean型

CByte(expression) '转换为Byte型

CCur(expression) '转换为Currency型

CDate(expression) '转换为Date型

CDbl(expression) '转换为Double型

CDec(expression) '转换为Decemal型

CInt(expression) '转换为Integer型

CLng(expression) '转换为Long型

CSng(expression) '转换为Single型

CStr(expression) '转换为String型

CVar(expression) '转换为Variant型

Val(string) '转换为数据型

Str(number) '转换为String

'银行家舍入法，对于尾数为5的情况，比如2.5，将其舍入到最近的偶数（即2），而并不总是进位。所以，cint(3.5)与cint(4.5)的结果都是4
round(x, n) 'vba系统函数，按照银行家舍入法对x进行四舍五入，并保留n位小数
application.worksheetfunction.round(x, 2) '此时可以正常四舍五入

int(x) '返回一个不大于x的最大整数，比如：int(4.8)返回4
int(x + 0.5) '相当于四舍五入
```

### 1.5 时间函数

```vb
Now '返回一个 Variant (Date)，根据计算机系统设置的日期和时间来指定日期和时间。

Date '返回包含系统日期的 Variant (Date)。(公元100年至公元9999年)
sub demo()
    dim d as date
    d = date
    msgbox d
end sub

Time '返回一个指明当前系统时间的 Variant (Date)。
sub demo()
    dim d as date
    d = time
    msgbox d
end sub

Timer '返回一个 Single，代表从午夜开始到现在经过的秒数。

TimeSerial(hour, minute, second) '返回一个 Variant (Date)，包含具有具体时、分、秒的时间。

DateDiff(interval, date1, date2[, firstdayofweek[, firstweekofyear]]) '返回 Variant (Long) 的值，表示两个指定日期间的时间间隔数目

Second(time) '返回一个 Variant (Integer)，其值为 0 到 59 之间的整数，表示一分钟之中的某个秒

Minute(time) '返回一个 Variant (Integer)，其值为 0 到 59 之间的整数，表示一小时中的某分钟

Hour(time) '返回一个 Variant (Integer)，其值为 0 到 23 之间的整数，表示一天之中的某一钟点

Day(date) '返回一个 Variant (Integer)，其值为 1 到 31 之间的整数，表示一个月中的某一日

Month(date) '返回一个 Variant (Integer)，其值为 1 到 12 之间的整数，表示一年中的某月

Year(date) '返回 Variant (Integer)，包含表示年份的整数。

Weekday(date, [firstdayofweek]) '返回一个 Variant (Integer)，包含一个整数，代表某个日期是星期几

datediff(单位， 起始时间， 截止时间)
单位：
"yyyy" - 年 "m" - 月 "q" - 季度 "d" - 日
"y" - 当年第几日，一般情况下运行结果与使用"d"相同
"w" - 周（按实际天数计算，不足7天为0周）
"ww" - 周（按跨越周日数计算，只要相隔一个周日即为一周）
"h" - 小时 "n" - 分钟 "s" - 秒
示例：datediff("yyyy", #8/3/1996#, #3/5/2003#)

dateadd(单位， 跨越长度， 起始时间)
示例：dateadd("d", 500, #3/29/2022#)
Sub s_5()
    Dim d As Date
    d = DateAdd("d", 500, #3/29/2022#)
    MsgBox d
End Sub

'注意日期就是数据
Sub s_6()
    Dim d As Date
    d = 1
    MsgBox d
End Sub
```



## 6.6 vba编辑器

- 在属性窗口进行改名等其他设置

- 强制转行：空格+下划线+回车

- F7运行，F8逐语句

- 断点：程序运行到某一段暂停

- 立即窗口

  - ```vb
    sub d()
        dim x as integer, st as string
        for x = 1 to 10
        st = st & cells(x,1)
        debug print "第" & x & "次运行结果:" & st
    next x
    end sub
    ```

- 本地窗口

  - ```vb
    '在本地窗口中可以显示运行中断时对象信息、变量值、数组信息等
    sub d1()
        dim x as integer, k as integer
        for x = 1 to 10
        k = k + cells(x,1)
        if k > 26 then
            stop
        end if
    next x 
    end sub
    ```


## 6.7 vba分支与end语句

- end语句：强制退出所有正在运行的程序
- exit：退出指定的语句

```vb
'exit sub
sub e1()
    dim x as integer
    for x = 1 to 100
    	cells(1,1) = x
    	if x = 5 then
        	exit sub
    	end if 
    next x
    range("b1") = 100
end sub
```

```vb
'退出程序
function ff()
    dim x as integer
    for x = 1 to 100
    	if x = 5 then
        	exit function
        end if 
    next x
    ff = 100
end function
```

```vb
'退出循环
sub e3()
    dim x as integer
    for x = 1 to 100
    	if x = 5 then
        	exit for
    	end if 
	next x
	range("b1") = 100
end sub
```

```vb
'退出do
sub s4()
    dim x as integer
    do 
        x = x + 1
        cells(1,1) = x
        if x = 5 then 
            exit do
            end if
        loop until x = 100
        range("b1") = 100
end sub    
```

- goto 语句，跳转到指定的地方

```vb
sub g1()
    dim x as integer
    dim sr
    100:
    sr = application.inputbox("请输入数字", "输入提示")
    if len(sr) = 0 or len(sr) = 5 then goto 100
    end sub
```

- gosub..return 跳过去再跳回来

```vb
sub g2()
    dim x as integer
    for x = 1 to 10
    if cells(x,1) mod 2 = 0 then gosub 100
    next x
    exit sub
        100:
        cells(x,1) = "偶数"
        e
    
```

## 6.8 录制宏

 ```vb
 font.color = -16776961  '字体颜色
 '进行增删时，一般倒序操作
 whlie i > 10
 表达式
 i = i
 wend
 ```

```vb
sub changunit()
    dim i j
    i = 2
    do while cells(i,1) <> ""
        for j = 2 to 10
        	cells(i,j) = cells(i,j) * 0.453
    	next j
    	i = i + 1
	loop
	cells(i,9) = "磅"
end sub
```

```vb
Sub 季度汇总()
    Dim i, j
    Dim q As Worksheet, w As Worksheet
    
    Set q = Worksheets("季度汇总")
    for i = 3 to 10
        name = cells(i, 2)    
        For Each w In Worksheets
            If Right(w.Name, 1) = "月" Then
                j = 3
                do while w.cells(j, 2) <> ""
                	if lcase(trim(w.cells(j, 2))) = lcase(trim(name)) then
                    	q.Cells(j, 3) = q.Cells(j, 3) + w.Cells(j, 3)
                	end if
                	j = j + 1
                loop
            End If
        Next w
	next i    
End Sub
```

```vb
sub 打开工作簿()
    '定义一个指向workbook类对象的变量wb
    dim wb as workbook
    
    set wb = workbooks.open("D:\季度汇总\4月.xlsx")
        
    wb.worksheets(1).cells(1, 1) = "hello!"
    
    wb.saveas "D:\test.xlsx"
    wb.worksheets.add
    wb.close
        
end sub
```

## 6.9 进阶篇

```vb
option explicit
sub test()
    '如果没有使用as指定一个变量的类型， 那么该变量被默认属于一种特殊类型，变体类型variant
    dim a as integer, b as string, c as integer, d as string
    
    a = 123
    b = "abc"
    c = 3257
    d = "大家好"
end sub
```

- string :文本
- date:日期
- integer:数字
  - byte, long, single, double,
  -  currency:4位小数
  - decimal
- Boolean：逻辑
- object: 对象
- variant:变体

```vb
Sub s_2()
    Dim a As Long
    a = 30000& * 2   '&符号说明前面的数字必须被当做long看待，无论其大小如何，防止溢出
        MsgBox a
End Sub

```

- 特殊字符代表数据类型

  ```vb
  % integer
  & long
  ! single
  # double
  @ currency
  $ string
  ```

- 其他特殊字符

  ```vb
  _ '换行，但字符串不能用，可以用&
  : '多行语句拼接成一行
  ^ '幂运算
  \ '整除
  ```

### 日期

```vb
Sub s_4()
    Dim d As Date
    
    d = #1/19/2016 12:20:25 PM#
    MsgBox d
End Sub

## '类似于双引号，用来声明是时间格式，默认格式月/日/年
```

### Boolean

```vb
Sub s()
    Dim wb As Workbook, ws As Worksheet
    Dim i%
    Application.DisplayAlerts = False
    Set wb = Workbooks.Open("f:\工作簿1.xlsm")
    Set ws = Worksheets(1)
    i = 2
    paint = False
    Do While Trim(ws.Cells(i, 1)) <> ""
        If Trim(LCase(ws.Cells(i, 1))) <> Trim(LCase(ws.Cells(i - 1, 1))) Then
            If paint = True Then
                paint = False
            Else
                paint = True
            End If
        End If
        
        If paint = True Then
            ws.Cells(i, 1).Interior.Color = RGB(255, 0, 0)
        End If
              
        
        i = i + 1
    Loop
    Application.DisplayAlerts = True
End Sub

```

```vb
'改成boolean形式
Sub s()
    Dim i%
    i = 2
    paint = False
    Do While Trim(Cells(i, 1)) <> ""
        If Trim(LCase(Cells(i, 1))) <> Trim(LCase(Cells(i - 1, 1))) Then
            paint = not paint
        End If
        
        If paint Then
            Cells(i, 1).Interior.Color = RGB(255, 0, 0)
        End If

        i = i + 1
    Loop
End Sub

```

```vb
'结束循环
sub findFirstData()
    dim i%, found as boolean
    found = false  
    do while found = false(或者not found) and cells(i, 6) <> ""
        if instr(cells(i, 6),"观音") > 0 then
            range(cells(i, 2), cells(i, 6).interior.color = rgb(255, 255, 0)
            found = true
        end if
        i = i + 1
    loop
end sub
```

```vb
'退出及出错操作
Sub findfirtdata()
    Dim a%
    On Error GoTo myerror(或者on error resume next)
100:
    a = Application.InputBox("请输入数字", "输入提示")
    If a = 0 Then
        Exit Sub
    ElseIf a = 200 Then
        GoTo 200
    
    Else
        a = Sqr(a)
        MsgBox a
        GoTo 100
    End If
200:
    a = Application.InputBox("enter a digital")
    
    
    
    If a = 0 Then
        Exit Sub
    ElseIf a = 100 Then
        GoTo 100
    
    Else
        a = a ^ 3
        MsgBox a
        GoTo 200
    End If
myerror:
    MsgBox "数字过大"
    GoTo 100
End Sub
```

### 数组

```vb
数组中的下标会自动四舍五入为整数

sub ChineseNumber()
    dim cn(x) as string  '表示数组，x表示cn数组的最大下标，从0开始(或者dim cn(3 to 9))
    cn(0) = "零": cn(1) = "壹": cn(2) = "贰": cn(3) = "叁"
    
    for i = 1 to 4
    	k = cells(i, 1)
    	cells(i, 1) = cn(k)
end sub
    
ubound(a) '数组a的最大下标数值'
lbound(a) '数组a的最小下标数值

'字符串拆分'
split(要拆分的字符串， 分隔符字符串) '存入数组中，即可得到拆分后的字符串数组
sub splitDemo()
    dim a() as string, i&, k&  'a() 动态数组，使用redim a(x)可以多次重新修改数组长度
    a = split(cells(1, 1), ",")
    k = 1
    for i = lbound(a) to ubound(a) (或者for each x in a,此时x必须是一个变体类型，即dim x)
    	cells(k, 2) = a(i)
    	k = k + 1
	next i
end sub

sub splitDemo_1()
dim s$, a() as string, x
dim b() as string, i&

end sub

Sub s_6()
   Dim a() As String, s$, i&, k, b() As String
   
   s = "张三，，，，李四，王五，，刘亦菲"
   a = Split(s, "，")
   i = 0
   For Each k In a
        If k <> "" Then
            i = i + 1
        End If
    Next k
    
    ReDim b(i)
    i = 0
    For Each k In a
        If k <> "" Then
            b(i) = k
            
            MsgBox b(i)
            i = i + 1
        End If
    Next k
End Sub
```

### 文本文件

一、读取文本文件

1. 打开文本文件

   - 找到指定文件并调入内存

   - ```vb
     dim s$, i&
     open "d:\***.txt" for input as #1 '打开指定文件，为了输入代号1，代表该文件
     
     input:输入到excel中
     output:从excel中输出
     ```

2. 读取一行内容

   - ```vb
     line input #1, s  '从#1中读取一行内容, 并保存到s中
     cells(1, 1) = s
     
     line input #1, s '再次读取就是第二行，依次类推'
     cells(2, 1) = s
     ```

3. 是否已到末尾

   - ```vb
     eof(n)  '判断代号n的文件是否到达文件末尾'
     
     do while eof(1) = false
         line input #1, s
         cells(i, 1) = s
         i = i + 1
     loop
     ```

4. 关闭文本文件

   - ```vb
     close #1
     ```

二、写入文本文件

```vb
open "d:\***.txt" for output as #1  '文件已存在则覆盖，无则创建'
open "d:\***.txt" for append as #1  '追加写入并保留原有内容'

print #1, trim(cells(3, 2))  '末尾空白代表换行'
print #1, trim(cells(3, 3)); '末尾分号代表相连'
print #1, trim(cells(3, 4))

close #1
```

三、读取文件夹

```vb
dir   '只搜寻文件名，不搜寻子文件夹的名字'’

dir("d:\demo\", vbdirectory)  '返回文件名及子文件夹名
```



```vb
dim f$

f = dir("d:\***\")   '选定该文件夹下第一个文件(***.txt)，以反斜杠“\”结尾代表文件夹，否则会被当做一个文件，即D盘下名为***的文件'

f = dir   '此时会得到其中一个文件'
f = dir   '继续得到一个文件'
```

```vb
do while f <> ""
    '进行打开操作'
    call readFromFile("d:\demo2\" & f)

    f = dir
loop

sub readFromFile(fullName as  string)
    dim ws as worksheet, i&, s$
    '创建新工作表， 并将表名改为文件名，instrrev函数与instr函数的功能相同，不过是从最右边开始查找字符'
    set ws = worksheets.add
        ws.Name = mid(fullName, instrrev(fullName, "\") + 1)
        
        open fullName for input as #1
        
        i = 1
        do while not eof(1)
            line input #1, s
            ws.cells(i, 2) = left(s, 2)
            ws.cells(i, 3) = mid(s, instr(s, "电话") + 3， 8)
            i = i + 1
        loop
        close #1
end sub
```

```vb
'*.xlsx代表只搜寻以.xlsx结尾的文件名'
dir("d:\demo\workbooks\*.xlsx")
dir("d:\demo\workbooks\a*.xlsx")  '文件名以a开头的'

```

### Range

```vb
range.row '该range左上角单元格的行号'
range.column '该range左上角单元格的列号'
range.address '该range各个对角顶点的绝对引用地址 $B$3'
注意：当range包含多个矩形区域时，row和column只返回其中某一个矩形的左上角的位置

application.selection.row  '选中的单元格的行数'
range.entirerow  '该单元格整行'
range.entirecolumn '该单元格整列'
range.count '该range中的单元格数量'
--1.range对象由多个矩形区域构成时，各矩形互相重叠的单元格会被重复计算
--2.count计算的其实是对象而非单元格的个数，而且当数量太大时回复发生溢出错误。所以最好的方法是：range.cells.countlarge

range.rows  '容纳了该range中的每一行，可以使用range.rows(n)得到一个新的range对象，代表位于该区域第n行的所有单元格'
注意：range只代表其中某个矩形区域的所有行
range.rows.count  '一共有多少行'

range.columns  '容纳了该range中的每一列，可以使用range.columns(n)'
range.columns.count

两种特殊的range对象
1.代表工作表中全部单元格的range对象 
worksheets.cells

2.涵盖工作表中全部使用过的单元格的range对象
worksheet.usedrange（activesheet.usedrange):'返回一个矩形区域的range对象，正好能够容纳这个工作表中所有使用过的单元格'
注意:全空的工作表，第一格会被视为usedrange
设置了格式的也会被选中

range.hasformula:'该单元格是公式返回true'
range.formula:'若是公式，返回公式文本，否则返回内容'
r.value = r.value   '只提取单元格中的数值'

application.union:'把多个range联合在一起，作为一个新的range对象返回'
set ru = union(r1, r2, r3)

application.intersect:'找到同时属于多个range的单元格（即重叠部分），作为一个新的range对象返回'

range.currentregion:'返回一个包含了这个range的最大连续使用区域，该区域与其他任何已使用单元格都不邻接'

range.resize:'以该range的左上角单元格为原点，生成一个指定大小的新range对象并返回'
r.resize(3, 2)

range.offset:'按照range的大小，根据指定的距离平行移动，从而得到一个新的同样形状的range。不会移动原对象，而是生成并返回一个新的range
r.offset(7, 3)  '向下平移7行，向右平移3列，正负号表示方向

activesheet.rows(n)  '当前工作表的第n行'
worksheets.rows和range.rows均可以一次返回多行
rows("2:3")、columns("B:E")

'合并单元格，多个单元格合并之后，仍被vba认为是各自独立的单元格'
'第一个单元格的值为合并后显示的内容，其他单元格被认为是空值
r.mergecells = true  '合并单元格'
r.merge
r.unmerge
r.merge true  '按行合并'
r.merge false '按列合并'

range.mergecells:'当该range完全合并为一个单元格时，该属性为true,当range完全不包含合并单元格时，为false，其他情况为null'
if r.mergecells = true|false
if isnull(r.mergecells)

r.select  '选中指定单元格'
set r = selection  '让r指向当前正被选中的单元格区域'

    
range("c4").select
with selection.interior
    .pattern = xlsolid
end with
等价于 
with range("c4").interior
end with
```

### 二维数组

```vb
dim arr(最大行， 最大列) as 类型
dim a(1 to 3, 2 to 6) as long
a(1, 3) = 7

从range中读取数组时，s()必须为动态数组且为变体类型
s = range("a1:z90")
ubound(s, 1)  '第一维的最大下标'
ubound(s, 2)  '第二维的最大下标'

一维数组不能从range中读入数据
但可以将内容写到range中
Sub demo_1()
    Dim s(3) As Integer, i%
    
    s(0) = 1: s(1) = 2: s(2) = 3: s(3) = 4
    
    Range("c2:c5") = Application.Transpose(s)  '写入某列要先转置'
End Sub
```

```vb
optional 可选参数
ismissing(a)  是否提供了a参数，该可选参数必须是变体类型且不能有默认值
if ismissing(a) then '如果没有可选参数a则执行下一条命令

function myFun(a, optional b = 0, optional c = 0) '可选参数b、c,且默认为0'
    myFun = a + b + c
end function

sub callDemo()
    dim x 
    x = myFun(3)
    x = myFun(3, 4)
    x = myFun(3, 4, 5)
    x = myFun(a:=3, c:=5)
end sub
    
拷贝工作表
sheets(2).copy after:=sheets(2) '复制工作表并放在表后'
    

```

### Msgbox

|      常量名称      | 数值 |           含义           |
| :----------------: | :--: | :----------------------: |
|      vbOkOnly      |  0   |      只显示确定按钮      |
|     vbOkCancel     |  1   |  显示确定按钮和取消按钮  |
| vbabortRetryIgnore |  2   | 显示放弃、重试、忽略按钮 |
|   vbYesNoCancel    |  3   |     显示是、否、取消     |
|      vbYesNo       |  4   |          是、否          |
|   vbRetryCancel    |  5   |        重试、取消        |
|     vbCritical     |  16  |       关键信息图标       |
|     vbQuestion     |  32  |         询问图标         |
|   vbExclamation    |  48  |         警告图标         |
|   vbInformation    |  64  |         消息图标         |

```vb
dim i
i = msgbox("请选择一个按钮", vbYesNo)
msgbox "刚才的msgbox返回值是" & i
```

| 常量名称 | 数值 | 含义 |
| :------: | :--: | :--: |
|   vbOk   |  1   | 确认 |
| vbCancel |  2   | 取消 |
| vbAbort  |  3   | 放弃 |
| vbRetry  |  4   | 重试 |
| vbIgnore |  5   | 忽略 |
|  vbYes   |  6   |  是  |
|   vbNo   |  7   |  否  |

### 参数

一、函数和子过程的括号

1. 没有参数：不写
2. 有参数，调用语句处于一行代码中间：写
3. 有参数，调用语句独占一行代码：不写
4. call后必须使用括号

二、参数传递方式

- 引用传递：传递给子过程的是变量本身，所以子过程内部可以直接修改该变量。关键字：ByRef，或者什么都不写（因为引用传递是VBA的默认传递方式）
- 值传递：传递给子过程的只是变量的值，子过程会根据这个值新建一个变量，一切修改也只针对这个新变量，不会改变主过程的原变量。关键字：ByVal。

```vb
sub 主过程()
    dim x%
    x = 1
    call 子过程(x)
    msgbox x
end sub

sub 子过程(a%)
    a = a * 2
end sub
```

### 随机数

randomize ：使得每次随机数都不相同，写在循环前

### 事件编程

用户在excel中的一个操作，或者excel系统自身的一个变化，都可以被视作一个”事件“。

excel会随时监听这些事件，并可以根据程序员的要求，在某个事件发生时自动运行对应的vba程序。

sheet1： 工作表事件代码

模块：普通宏代码

ThisWorkbook：工作簿事件代码

常用工作簿事件名称与对应处理过程名称示例：

| 事件名称    | 触发该事件的时间     | 规定的处理过程名称   |
| ----------- | -------------------- | -------------------- |
| Activate    | 工作簿被激活时       | Workbook_Activate    |
| Open        | 工作簿被打开时       | Workbook_Open        |
| BeforeClose | 关闭工作簿之前       | Workbook_BeforeClose |
| BeforeSave  | 保存工作簿之前       | Workbook_BeforeSave  |
| BeforePrint | 打印工作簿之前       | Workbook_BeforePrint |
| NewSheet    | 在工作簿中新建工作表 | Workbook_NewSheet    |

```vb
每新增一个表同时携带内容
private sub workbook_Newsheet(Byval sh as Object) 'sh代表新建的工作表对象
    sh.range("a1") = "hello"
end sub

'鼠标跟随颜色'
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    Cells.Interior.Color = xlNone   '透明'
    With Target
        .EntireRow.Interior.Color = vbCyan
        .EntireColumn.Interior.Color = vbCyan
    End With
End Sub

'在模块中写功能'
sub highlight(r as range)
    Cells.Interior.Color = xlNone
    With r
		.EntireRow.Interior.Color = vbCyan       '整行'
        .EntireColumn.Interior.Color = vbCyan
    End With
End Sub
'在Worksheet_SelectionChange中调用
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
	call 模块1.highlight(target)
end sub

事件名称：change
触发条件：当一个单元格处于编辑状态或发生变化时会触发本事件
响应函数：worksheet_change(target)

事件级联避免：
--使用静态变量为代码“加锁”
--使用application.enableEvents属性：true-允许响应新的excel事件；false不允许
application.enableEvents = false
target.value = "要执行的事件"
application.enableevents = true
```

### 变量和过程（函数）的作用域

- 标记为private：只能被本模块内部的代码调用
- 标记为public：可以被其他模块的代码调用
- 子过程与函数若不指明，默认为public
- 变量若不指明，默认为private

### 用户窗体编程

在excel中直接添加activateX控件,代码编辑的功能比直接控件的功能更方便

设计Windows风格的窗口界面，可以容纳文本框、按钮等各种控件，实现图形化用户交互功能

- enable属性：true正常工作，false该控件显示为灰色状态，无法使用

- visible属性：false时该控件自动隐藏，true则正常显示

- 单选按钮和复选框的value属性: 如果被选中，value为true

- frame框架可以进行分组

  - ```vb
    Private Sub CommandButton1_Click()
        Dim gender$, interest$, age$
        
        If OptionButton1.Value Then
            gender = "男性"
        ElseIf OptionButton2.Value Then
            gender = "女性"
        Else
            gender = "未注明"
        End If
        Cells(4, 2) = gender
        
        If OptionButton4.Value Then
            age = "12~18岁"
        ElseIf OptionButton5.Value Then
            age = "12~18岁"
        Else
            age = "12~18岁"
        End If
        
        Cells(4, 3) = age
        
        If CheckBox1.Value Then interest = interest & "音乐"
        If CheckBox2.Value Then interest = interest & "体育"
        If CheckBox3.Value Then interest = interest & "美术"
        
        Cells(4, 4) = interest
    End Sub
    
    ```

- image控件：

  - picture:要显示的图片对象，可在属性窗口中设置，也可用代码loadpicture("文件路径")设置

    - ```vb
      image1.picture = loadpicture(" ")
      
      Private Sub Image1_Click()
          Dim im As Image
          Set im = Image1
          im.Picture = LoadPicture("C:\Users\Administrator\Desktop\微信图片_20220406141158.jpg")
          im.PictureSizeMode = fmPictureSizeModeZoom
          im.Width = 200
          im.Height = 300
          
      End Sub
      ```

      

  - pictureSize属性：设定该图片的显示模式，包括“原尺寸”、“拉伸”、“自适应”等。

- 文本框的text属性：代表文本框当前显示的字符串

- form.show：显示窗体   #form是窗体名称

- form.hide：隐藏窗体     #只是隐藏不是销毁，该窗体及其特征、内容都完好保存在内存中

- unload 窗体或控件名 : 将一个窗体或控件等对象从内存中彻底清除、销毁

窗口的关闭按钮的效果相当于unload，完全清除

- multiline 可以输入多行

- wordwrap 自动换行

- scrollbars  显示滚动条

- 列表框：将各个条目分别写在工作表单元格中，使用rowsource

  - 方法一、listbox.rowsource = "sheet1!d2:d9"

  - 方法二、当窗体刚刚创建时，将数组赋值给listbox

    - ```vb
      Private Sub UserForm_Initialize()
          Dim a(4) As String
          a(0) = "金融"
          a(1) = "经济学"
          a(2) = "大数据"
          a(3) = "应用统计"
          a(4) = "管理学"
          
          ListBox1.List = a
      End Sub
      ```

  - 二者不能共用
  
  - 方法三、additem
  
    - ```vb
      listbox.additem "钱"
      ```
  
    - ```vb
      listbox.removeitem num  '从0开始，移除第n个条目'
      listbox1.removeitem 3   '移除第4个条目'
      ```
  
    - ```vb
      '点击时显示列表内容'
      If Not IsNull(ListBox1.Value) Then
              MsgBox ListBox1.Value
          End If
      ```
  
    - ```vb
      listbox1.listindex '被选中条目的序号，从0开始计数，未做选择时为-1'
      ```
  
    - ```vb
      '点击按钮显示学生信息'
      Private Sub 显示学生信息_Click()
          Dim i%
          If ListBox1.ListIndex > -1 Then
              i = ListBox1.ListIndex + 15
              TextBox1.Text = Cells(i, 5)
              TextBox2.Text = Cells(i, 6)
              TextBox3.Text = Cells(i, 7)
              TextBox4.Text = Cells(i, 8)
              TextBox5.Text = Cells(i, 9)
          End If
      End Sub
      ```
  
    - ```vb
      '点击条目显示学生信息'
      Private Sub ListBox1_Click()
          Dim i%
          If ListBox1.ListIndex > -1 Then
              i = ListBox1.ListIndex + 15
              TextBox1.Text = Cells(i, 5)
              TextBox2.Text = Cells(i, 6)
              TextBox3.Text = Cells(i, 7)
              TextBox4.Text = Cells(i, 8)
              TextBox5.Text = Cells(i, 9)
          End If
      End Sub
      ```
  
    - ```vb
      '下拉列表框'
      Private Sub ComboBox1_Change()
          Dim i%
          If ComboBox1.ListIndex > -1 Then
              i = ComboBox1.ListIndex + 15
              TextBox1.Text = Cells(i, 5)
              TextBox2.Text = Cells(i, 6)
              TextBox3.Text = Cells(i, 7)
              TextBox4.Text = Cells(i, 8)
              TextBox5.Text = Cells(i, 9)
          End If
      End Sub
      ```
  
    - 

```vb
'按钮代码'
Private Sub CommandButton2_Click()
    Dim i&, r As Range
    
    Set r = Worksheets(1).UsedRange
    
    i = r.Row + r.Rows.Count
    
    Cells(i, 3) = txtName.Text
    Cells(i, 4) = txtAge.Text
    
    Unload UserForm1
End Sub
```

```vb
'双击显示该单元格窗口内容'
Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
    UserForm1.txtName.Text = Cells(Target.Row, 3)
    UserForm1.txtAge.Text = Cells(Target.Row, 4)
    
    UserForm1.Show
End Sub
```

```vb
enable
```



### 全局变量

特点：可以被所有模块中的各个过程调用、读取，因此可以实现不同模块之间的数据交流

用法：1.不能声明在过程或函数内部

​			2.使用public，表明其为公共变量

```vb
'模块1'
public rowNum as long
'工作表中双击某单元格时'
模块1.rowNum = target.row
'窗体中'
i = 模块1.rowNum
```

### 图表

图表对象

- ChartObject
- worksheet.ChartObjects

```vb
ChartObjects.count '该工作表中当前的图表总数
ChartObjects(k)   '该工作表中第k个图表对象
ChartObjects.Add   '在该工作表中新建一个空白图表
ChartObjects.delete  '将该工作表中所有图表全部删除'
```

```vb
'单表显示
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    Dim mycha As ChartObject, ws As Worksheet, row&
    
    Set ws = Worksheets(1)
    row = Target.row
    
    '如果选中的单元格处于第15行和22行之间，则设置图表
    If row >= 15 And row <= 22 Then
        '如果工作表中还没有图表则新建一个空白图表并让mycha指向它
        '如果已经有图表，则直接让mycha指向它
        If ws.ChartObjects.Count = 0 Then
                Set mycha = ws.ChartObjects.Add(80, 240, 300, 200)  '图表位置，图表大小，依次是左，上，宽， 高
        Else
            Set mycha = ws.ChartObjects(1)
        End If
        
        '设置mycha对象的chart属性（也是一个对象），使之显示该行数据趋势
        With mycha.Chart
            .ChartType = xl3DLine '设置图表类型为折线图
            .SetSourceData Source:=Range(ws.Cells(row, 5), ws.Cells(row, 9))
            .HasTitle = True   '为该图表添加一个空白的标题
            .ChartTitle.Text = ws.Cells(row, 4) '设置刚添加的标题为学生名称
            
        End With
    End If
    
End Sub
```

```vb
'多表显示
sub trendCharts()
    Dim mycha As ChartObject, ws As Worksheet, i&, j&
    
    Set ws = Worksheets(1)

	 If ws.ChartObjects.Count > 0 Then ws.ChartObjects.Delete
    for i = 15 to 22
        '根据i的数值，生成本张图表的左上角坐标位置，使之不会相互重叠
        set mycha = ws.chartobjects.add(
                ((i - 15) mod 3) * 350 + 50, (int((i - 15)/3) + 1) * 250, 300, 200)		left依次增加，每3次循环一次，top每3次改变一次
        '设置mycha对象的chart属性（也是一个对象），使之显示该行数据趋势
        With mycha.Chart
            .ChartType = xl3DLine '设置图表类型为折线图
            .SetSourceData Source:=Range(ws.Cells(i, 5), ws.Cells(i, 9))
            .HasTitle = True   '为该图表添加一个空白的标题
            .ChartTitle.Text = ws.Cells(i, 4) '设置刚添加的标题为学生名称
            
        End With
	next i
    
End Sub
```

```vb
'保存图表'
mycha.chart.export "d:\***.gif"
```

#### ChartType

| 柱形图                       |                           |
| ---------------------------- | ------------------------- |
| 簇状                         | xlColumnClustered         |
| 三维簇状柱形图               | xl3DColumnClustered       |
| 堆积柱形图                   | xlColumnStacked           |
| 三维堆积柱形图               | xl3DColumnStacked         |
| 百分比堆积柱形图             | xlColumnStacked100        |
| 三维百分比堆积柱形图         | xl3DColumnStacked100      |
| 三维柱形图                   | xl3DColumn                |
| 条形图                       |                           |
| 簇状条形图                   | xlBarClustered            |
| 三维簇状条形图               | xl3DBarClustered          |
| 堆积条形图                   | xlBarStacked              |
| 三维堆积条形图               | xl3DBarStacked            |
| 百分比堆积条形图             | xlBarStacked100           |
| 三维百分比堆积条形图         | xl3DBarStacked100         |
| 折线图                       |                           |
| 折线图                       | xlLine                    |
| 数据点折线图                 | xlLineMarkers             |
| 堆积折线图                   | xlLineStacked             |
| 堆积数据点折线图             | xlLineMarkersStacked      |
| 百分比堆积折线图             | xlLineStacked100          |
| 百分比堆积数据点折线图       | xlLIneMarkersStacked100   |
| 折线图三维折线图             | xl3DLine                  |
| 饼图                         |                           |
| 饼图                         | xlPie                     |
| 分离型饼图                   | xlPieExploded             |
| 三维饼图                     | xl3Dpie                   |
| 三维分离型饼图               | xl3DPieExploded           |
| 复合饼图                     | xlPieOfPie                |
| 饼图复合柱饼图               | xlBarOfPie                |
| XY                           | (散点图)                  |
| 散点图                       | xlXYScatter               |
| 平滑线散点图                 | xlXYScatterSmooth         |
| 无数据点折线散点图           | xlXYScatterLinesNoMarkers |
| 折线散点图                   | xlXYScatterLines          |
| 无数据点折线散点图           | xlXYScatterLinesNoMarkers |
| 气泡图                       |                           |
| 气泡图                       | xlBubble                  |
| 三维气泡图                   | xlBubble3DEffect          |
| 面积图                       |                           |
| 面积图                       | xlArea                    |
| 三维面积图                   | xl3DArea                  |
| 堆积面积图                   | xlAreaStacked             |
| 三维堆积面积图               | xl3DAreaStacked           |
| 百分比堆积面积图             | xlAreaStacked100          |
| 三维百分比堆积面积图         | xl3DAreaStacked100        |
| 圆环图                       |                           |
| 圆环图                       | xlDoughnut                |
| 分离型圆环图                 | xlDoughnutExploded        |
| 雷达图                       |                           |
| 雷达图                       | xlRadar                   |
| 数据点雷达图                 | xlRadarMarkers            |
| 填充雷达图                   | xlRadarFilled             |
| 曲面图                       |                           |
| 三维曲面图                   | xlSurface                 |
| 曲面图（俯视图）             | xlSurfaceTopView          |
| 三维曲面图（框架图）         | xlSurfaceWireframe        |
| 曲面图（俯视框架图）         | xlSurfaceTopViewWireframe |
| 股价图                       |                           |
| 盘高-盘低-收盘图             | xlStockHLC                |
| 成交量-盘高-盘低-收盘图      | xlStockVHLC               |
| 开盘-盘高-盘低-收盘图        | xlStockOHLC               |
| 成交量-开盘-盘高-盘低-收盘图 | xlStockVOHLC              |
| 圆柱图                       |                           |
| 簇状柱形圆柱图               | xlCylinderColClustered    |
| 簇状条形圆柱图               | xlCylinderBarClustered    |
| 堆积柱形圆柱图               | xlCylinderColStacked      |
| 堆积条形圆柱图               | xlCylinderBarStacked      |
| 百分比堆积柱形圆柱图         | xlCylinderColStacked100   |
| 百分比堆积条形圆柱图         | xlCylinderBarStacked100   |
| 三维柱形圆柱图               | xlCylinderCol             |
| 圆锥图                       |                           |
| 簇状柱形圆锥图               | xlConeColClustered        |
| 簇状条形圆锥图               | xlConeBarClustered        |
| 堆积柱形圆锥图               | xlConeColStacked          |
| 堆积条形圆锥图               | xlConeBarStacked          |
| 百分比堆积柱形圆锥图         | xlCone                    |

### 正则表达式

不是元字符就会被视作文字

**重复结构**

| +     | 前面的内容连续出现1次或多次 |
| ----- | --------------------------- |
| *     | 前面的内容出现0次或多次     |
| ？    | 前面的内容出现0次或1次      |
| {n}   | 前面的内容正好出现n次       |
| {n,m} | 出现n到m次                  |

**指代特定内容的元字符**

| \d   | 数字字符                                                |
| ---- | ------------------------------------------------------- |
| \D   | 所有非数字字符                                          |
| \w   | 文字（包括数字和下划线）字符                            |
| \W   | 所有非文字字符                                          |
| \s   | 空白字符（空格、换行等）（单指一个，叠加*使用）         |
| \S   | 所有非空白字符                                          |
| .    | 所有字符，但默认时不能代表换行符（单指一个，叠加*使用） |

**贪婪搜索原则**：以某个字符为起始（比如3），如果同时有多个符合要求的字符串（比如3+5， 3+5 2+7），则选择最长的一个作为最终结果

**懒惰搜索**：当有多个以同一字符为开始、并且符合查询条件的字符串时，选择第一个也就是最短的一个作为结果

| a*      | 贪婪搜索，找a最多的那个             |
| ------- | ----------------------------------- |
| a*?     | 懒惰搜索，可以有任意个a，但尽可能少 |
| a+?     | 一个或多个a，但尽可能少             |
| a??     | 零个或一个a，但尽可能少             |
| a{3,8}? | 3到8个a，但尽可能少                 |

**[ ] 字符**

- \[ ]  代表一个字符，且必须是方括号内字符之一  [ab12]:一个字符，且只能是a b 1 2中某一个

- . + * ? 等元字符出现在[ ]中时，自动转义成普通文字，但\d\s\w等仍然保持元字符含义
- 如果^出现在[ ]第一位，则该字符代表一个未在方括号列出的字符。例如：[^abc】可以是任意字符，除了a、b、c      【^\d】即任何一个非数字的字符，相当于\D。由于\D有时会引起乱码，所以此表示法也很常用

**- 字符**

- 出现在两个字符之间，则代表所有编码大于左侧、小于右侧的字符。

| [c-f] | 等同于[cdef]   |
| ----- | -------------- |
| [3-8] | 等同于[345678] |
| [e-a] | 出错           |

**（）分组**

- （）中的字符将被视作同一个整体，可以使用一个元字符（如+）指定他们共同出现的次数

| 分枝

- 代表或者
- \d{5}-\d{4}|\d{5}这个表达式用于匹配美国的邮政编码。美国邮编的规则是5位数字，或者用连字号间隔的9位数字。之所以要给出这个例子是因为它能说明一个问题：**使用分枝条件时，要注意各个条件的顺序**。如果你把它改成\d{5}|\d{5}-\d{4}的话，那么就只会匹配5位的邮编(以及9位邮编的前5位)。原因是匹配分枝条件时，将会从左到右地测试每个条件，如果满足了某个分枝的话，就不会去再管其它的条件了。

# 七、ORM

- 常用的orm框架：EF6、NHibernate、Dapper、IBatis.Net、LinqTosql
- 包含对象的CRUD操作的API 
- Mapping映射生成实体/数据库/
- 事务/延迟/缓存等等高级特性
- 也能够从

# 八、算法

- 算法（Algorithm) : 一个计算过程，解决问题的方法
- Niklaus Wirth: “程序=数据结构+算法”

## 8.1 时间复杂度

O(1)

```python 
print('hello World')
```

O(n)

```python
for i in range(n):
    print('hello world')
```

$$ O(n^2) $$

```python 
for i in range(n):
    for j in range(n):
        print('hello world')
```

$$ O(n^3) $$

```python
for i in range(n):
	for j in range(n):
		for k in range(n):
            print('hello world')
```

- 上面四组代码，那组运行时间最短？

- 用什么方式来体现算法运行的快慢？

》时间复杂度：用来评估算法运行效率的一个式子,记为$$ O(log_{2}n) $$ 或O(logn)

》当算法中出现循环折半的时候，复杂度式子中会出现logn。

### 8.1.1 时间复杂度小结

- 时间复杂度是用来估计算法运行时间的一个式子（单位）。
- 一般来说，时间复杂度高的算法比复杂度低的算法慢。
- 常见的时间复杂度（按效率排序）
  - $$ O(1) < O(logn) < O(n) < O(logn) < O(n^2) < O(n^{2}logn) < O(n^3) $$
- 复杂问题的时间复杂度
  - $$ O(n!)  O(2^n)  O(n^n) ... $$

### 8.1.2 如何简单快速地判断算法复杂度

- 确定问题规模n
- 循环减半过程 —> logn
- k层关于n的循环 —> $$ n^K $$
- 复杂情况：根据算法执行过程判断

## 8.2 空间复杂度

- 空间复杂度：用来评估算法内存占用大小的式子
- 空间复杂度的表示方式与时间复杂度完全一样
  - 算法使用了几个变量：$$ O(1) $$
  - 算法使用了长度为n的一维列表：$$ O(n) $$
  - 算法使用了m行n列的二维列表：$$ O(mn) $$
- ” 时间换空间 “

## 8.3 列表查找

- 查找：在一些数据元素中，通过一定的方法找出与给定关键字相同的数据元素的过程
- 列表查找（线性表查找）：从列表中查找指定元素
  - 输入：列表、待查找元素
  - 输出：元素下标（未找到元素时一般返回None或-1
- 内置列表查找函数：index()

### 8.3.1 顺序查找(Linear Search)

- 顺序查找：也叫线性查找，从列表第一个元素开始，顺序进行搜索，直到找到元素或搜索到列表最后一个元素为止。

- 时间复杂度：$$ O(n) $$

  ```python 
  def linear_search(li,val):
      for ind, val in enumerate(li):
          if v == val:
              return ind
          else:
              return None
  ```

### 8.3.2 二分查找(Binary Search)

- 二分查找：又叫折半查找，从有序列表的初始候选区li[0:n]开始，通过对待查找的值与候选区中间值的比较，可以使候选区减少一半。

时间复杂度：$$ O(logn) $$

```python
def binary_search(li,val):
    left = 0
    right = len(li) - 1
    while left <= right:	#候选区有值
        mid = (left+right) // 2
        if li[mid] == val:
            return mid
        elif li[mid] > val:	#待查找的值在mid左侧
            right = mid - 1
        else:	#li[mid] < val 待查找的值在mid右侧
            left = mid +1
    else:
        return None
li = []
```

## 8.4 列表排序

- 排序:将一组"无序"的记录序列调整为"有序"的记录序列
- sort()

### 常见排序算法

- 冒泡排序、选择排序、插入排序；

- 快速排序、堆排序、归并排序；
- 希尔排序、计数排序、基数排序

#### 8.4.1 冒泡排序(Bubble Sort)

- 列表每两个相邻的数，如果前面比后面大，则交换这两个数
- 一趟排序完成后，则无序区减少一个数，有序区增加一个数

时间复杂度：$$ O(n^2) $$

```python 
import random
def bubble_sort(li):
    for i in range(len(li)-1):	#第i趟
        exchange = False
        for j in range(len(li)-i-1):
            if li[j] > li[j+1]:
                li[j], li[j+1] = li[j+1],li[j]	#交换
        		exchange = True
        if not exchange:
            return
li = [random.randint(0,10000) for i in range(1000)]
print(li)
bubble_sort(li) 
print(li)
```

#### 8.4.2选择排序(Select Sort)

- 一趟排序记录最小的数，放到第一个位置
- 再一趟排序记录列表无序区最小的数，放到第二个位置
- 算法关键点：有序区和无序区、无序区最小数的位置

时间复杂度：$$ O(n) $$（包含两个O(n)）

```python
def select_sort_simple(li):
    li_new = []
    for i in range(len(li)):
        min_val = min(li)
        li_new.append(min_val)
        li.remove(min_val)	#又遍历了一遍
    return li_new
li =[random.randint(0,10000) for i in range(1000)]
select_sort_simple(li)
```

```python
def select_sort(li):
    for i in range(len(li)-1):   #i是第几趟
        min_loc = i
        for j in range(i+1,len(li)):
            if li[j] < li[min_loc]:
                min_loc = j
        li[i], li[min_loc] = li[min_loc],li[i]
```

#### 8.4.3 插入排序(Insert Sort)

- 初始时手里（有序区）只有一张牌
- 每次（从无序区）摸一张牌，插入到手里已有牌的正确位置

```python
def insert_sort(li):
    for i in range(1,len(li)):	#i表示摸到的牌的下标
        tmp = li[i]
        j = i - 1	#j表示手里的牌的下标
        while j >= 0 and li[j] > tmp:
            li[j+1] = li[j]
            j -= 1
        li[j+1] = tmp
        
```

random.shuffle()打乱顺序

####  8.4.4 快速排序

- 排序思路：
  - 取一个元素p(第一个元素)，使元素p归位
  - 列表被p分成两部分，左边都比p小，右边都比p大
  - 递归完成排序















# 九、POWER BI

## 9.1 界面认识与矩阵表操作

### 9.1.1 设置视觉对象格式

- 大小
- 行填充、全局字号
- 列宽：自动调整
- 自动换行：关闭之后拖拽表格可以隐藏某列
- 筛选器里可以去掉某行
- 常规：标题中选对齐方式
- 渐变：分开行
- 总计
- 单元格元素：图标

### 9.1.2 新建列

点击新建列

- [字段名]
- 当列值来自不同表时，[表名] [字段名]
- related 可以连接两个表的数据插入新列

- 新建列是行上下文，新建度量值是筛选上下文，但加calculate就可以进行新建列筛选

## 9.2 快捷键

Ctrl+C 复制行（空选）  

Ctrl+G 转到行…  

Ctrl+I 选择当前行  

Ctrl+M 切换 tab 键移动焦点  

Ctrl+U 撤消上一个光标操作  

Ctrl+X 剪切行（空选）  

Ctrl+Shift+Enter 在上方插入行  

Alt+Enter 在下方插入行（不缩进） 

Shift+Enter 在下方插入行（缩进）  

Ctrl+Shift+\ 跳转到匹配的括号  

Ctrl+Shift+K 删除行  

Ctrl+] / [ 向右缩进/向左缩进  

Ctrl+Home 转到文件开头  

Ctrl+End 转到文件结尾  

Ctrl+↑/↓ 向上/向下滚动行  

Ctrl+Shift+Alt+（箭头键） 列（框）选择  

Ctrl+Shift+Alt+PgUp/PgDn 上翻/下翻列（框）选择页面 

Ctrl+Shift+L 为所选内容突出显示所有的匹配项，批量编辑  

Ctrl+Alt+↑/↓ 在上方/下方插入光标，同时编辑多行  

Ctrl+F2 选择当前词语的所有匹配项  

Shift+Alt+（拖动鼠标） 列（框）选择 

 Shift+Alt + ↓/↑ 向上/向下复制行  

Shift+Alt+→ 展开所选内容  

Shift+Alt+← 收缩选定内容  

Shift+Alt+I 将光标插入所选每行的末尾  

Alt+↑/↓ 向上/向下移动选中的行  

Alt+PgUp / PgDn 向上/向下滚动页面  

Alt+Click 插入光标  

Home / End 转到行的开头/结尾

## 9.3 DAX 函数

### 一.筛选类函数

```python
1.ALL, ALLEXCEPT, ALLSELECTED
ALL(table/column)  --ALL用来清除整个表或某个字段的筛选条件，通常配合CALCULATE使用
ALLEXCEPT(table/column) --删除表中除已应用于指定列的筛选器之外的所有上下文筛选器
ALLSELECTED(table/column) --从当前查询的列和行中删除上下文筛选器，同时保留所有其他上下文筛选器或显式筛选器
ALLNOBLANKROW  返回表中除空白行以外的所有行


2.CALCULATE(<expression>,<filter1>,<filter2>...)
--Calculate可以应用在多个表
  Calculate使用AND关系时可直接在条件间加',',但表达“或”时，必须用'||',而且连接的两个条件必须引用同一列。
  Calculate中当“[列] = 固定值”这种筛选搞不定时，可用filter/all/values筛选器搭配使用
--先筛选后计算

3.FILTER(table,<filter>)  --返回值（是一张表）：只包含筛选行数据的表
--筛选时对表进行逐行扫描，计算量很大，所以选择筛选的表尽量为lookup表

4.HASONEVALUE(<columnName>) --将 columnName 的上下文筛选为只剩下一个非重复值时，
                              将返回 TRUE。 否则为 FALSE。

5.RELATED(<column>)  --将“一”端的列值添加到“多”端的表中
  RELATEDTABLE(<tableName>) --将“多”端关联的表数据添加到“一”端的列上，返回的是一张表

6.VALUES(<TableNameOrColumnName>)  --返回由一列构成的一个表，该表包含来自指定表或列的非重复值。 换言之，重复值将被删除，仅返回唯一值。

7.EARLIER函数：
  例如我们有“产品名称”和“销售金额”两列数据。基于此，我们希望计算出每个产品的销售金额排名。
  COUNTROWS(
            FILTER('产品销售表',
                   EARLIER('产品销售表'[销售金额])<'产品销售表'[销售金额])
           )+1
  --EARLIER=当前行，按照当前行进行逐行扫描，SUMX+FILTER+EARLIER 
    是Power Pivot中比较常用的函数组合，由于Earlier针对每一行数据都进行计算，
    所以理论上计算量相当于数据行数的平方。如果有10行数据，则需要计算100次，
    所以数据量大的时候大家使用要小心，有可能会造成模型计算缓慢。
    
8.summarizecolumns（<去重的字段名>,可多列),返回的是表
--summarizecolumns('分组求和'[年份], '分组求和'[姓名], "总分", calculate(sum('分组求和'[成绩])))
--summarizecolumns('案例'[年份], '案例'[姓名], filter('案例'， '案例'[科目] = '数学')， '数学最高分值', calculate(max('案例'[成绩])))

```

### 二.逻辑与逻辑判断函数

```python
1.IF(logical_test>,<value_if_true>, value_if_false)
  --检查是否满足作为第一个参数提供的条件。 如果该条件为 TRUE，则返回一个值；如果该条件为 FALSE，则返回另一个值，用法与excel类似

2.SWITCH(<expression>,条件1,值1,条件2,值2)  --根据值列表计算表达式，并返回多个可能的结果表达式之一。

3.CONTAINS(InternetSales, [ProductKey], 214, [CustomerKey], 11185)
  --是否同时存在销售给客户 11185 的产品 214 的任何 Internet 销售额。
    
4.ISBLANK(column) --判断该列中某个值是否为空

5.ISNONTEXT(column)  --检查某个值是否不是文本

6.ISNUMBER(column)  --检查某个值是否为数字

7.ISTEXT(column)    --检查某个值是否为文本

8.ISLOGICAL(column) --检查某个值是否是逻辑值
```

### **三.时间日期类函数**

```python
1.计算年初至今累计--TOTALYTD函数
  例如计算年初至今累计的销售金额：
[年累计金额]：= TOTALYTD([销售金额], '日历年'[日期])
# 如果要加上一个时间截止点，则写为：
[年累计截止金额]：= TOTALYTD([销售金额], '日历年'[日期], '日历年'[日期]<DATE(2016,6,1))
# 同理计算季度初至今累计--TOTALQTD, 计算月初至今累计--TOTALMTD

2.计算上一年/季度/月的销售额--DATEADD函数
[上一年销售额]:= CALCULATE([销售金额], DATEADD('日历年'[日期],-1,YEAR))  
 --YEAR可改为QUARTER,MONTH,DAY
 --将-1改为+1则时间后移

3.计算同比/环比
# 月同比--今年每月的销售金额相比去年同月份增长的比率
[上一年销售额]:= CALCULATE([销售金额], DATEADD('日历年'[日期],-1,YEAR))
[同比]:= DIVIDE([销售金额]-[上一年销售额], [上一年销售额])

# 月环比--这月与上月相比销售额增长的比率
[上一月销售额]:= CALCULATE([销售金额], DATEADD('日历年'[日期],-1,MONTH))
[环比]:= DIVIDE([销售金额]-[上一月销售额], [上一月销售额])

4. 计算两个日期之间间隔--DATEDIFF
[时间间隔]:= DATEDIFF([开始日期], [结束日期], 'Y')   
    --参数"Y"换成"M"或"D",则分别对应月和日
    --也可以改成HOUR,MINUTE,SECOND计算小时，分，秒

5.其他日期时间函数：
DATE(2009,7,8)  --结果返回'2009/7/8 0：00：00'
DATEVALUE("8/1/2009")  --将文本形式的日期转换为日期时间格式的日期，结果返回'2009/8/1 0：00：00'
DATEADD([日期],3,DAY)  --日期加减函数
EOMONTH([日期],3)      --返回指定月份数之前或之后的月份的最后一天的日期
EDATE([日期],3)        --返回在开始日期之前或之后指示的月数的日期   
YEAR(),MONTH(),DAY(),HOUR(),MINUTE(),SECOND()
NOW() --返回当前的日期时间  TODAY()--返回当前的日期          
WEEKDAY([日期],1)  --一周中的第几天,参数1代表从星期日开始计数，参数2代表从星期一开始计数,参数3代表从星期一开始计数，但到星期六结束
WEEKNUM([日期],1)  --一年中的第几周，1代表从周日开始计数，2代表从周一开始计数  
```

### **四.统计聚合函数**

```python
1. SUMX(table,<expression>)  --SUMX与CALCULATE功能类似，但SUMX属于迭代函数，计算量大
                             --同理AVERAGEX,MINX.MAXX用法相同
2. SUM(),MAX(),MIN(),SQRT()
   DISTINCTCOUNT()--计算去重后列所包含的元素个数
   COUNTROWS()  --计算表的行数
   COUNT()  --计算列中包含数字的单元的数目
   COUNTA()  --计算列中不为空的单元的数目
   COUNTBLANK()  --计算列中空白单元的数目

3.DIVIDE(分子，分母)  --在DAX中涉及到除法必须用DIVIDE

4.CROSSJOIN(<table1>, <table2>)  --生成笛卡尔积表
  SUMMARIZE(<table>, <groupBy_columnName>,<name>,<expression>)
  --table,任何返回数据表的 DAX 表达式。
    groupBy_columnName将使用该列中找到的值创建摘要组,此参数不能是表达式。
    name,给予总计或汇总列的名称，包含在双引号内。
    expression,任何返回单个标量值的 DAX 表达式，其中，表达式将计算多次（针对每行/上下文）。
  GENERATE(<table1>, <table2>)--生成笛卡尔积表

5.AVERAGEA:数值相加除以总行数（包括非数值）
  AVERAGE:数值相加除以数值
```



# 十、编程

- 类与类之间的关系
  - 依赖关系

```python
class Dog:
    def __init__(self, name, age, breed, master):
        self.name = name
        self.age = age
        self.breed = breed
        self.master = master #master传进来的应该是个对象
        self.say_hi() #调用自己的方法，在实例化的时候
    def sayhi(self):
        print("Hi, I'm %s, a %s dog, my master is %s" %(self.name, self.master.name))
        
class Person:
    def __init__(self, name, age, sex):
        self.name = name
        self.age = age
        self.sex = sex
    def walk_dog(self, dog_obj):
        print("主人[%s]带狗[%s]去溜溜..." % (self.name, dog_obj.name))

p_1 = Person("duliang", 25, "m")
d_1 = Dog("mjj", 5, "阿拉斯加", p_1)
```

- 关联关系

```python
class Person:
    def __init__(self, name, age, sex):
        self.name = name
        self.age = age
        self.sex = sex
        self.parter = None  #应该是一个对象，代表另一半
    def do_private_stuff(self):
        pass
p_1 = Person("mjj", 24, "m")
p_2 = Person("lyy", 22, "f")

#双向关联
p_1.parter = p_2
p_2.parter = p_1

print(p_1.parter.name, p_2.parter.name)

#解除绑定
p_2.parter = None
```



- 组合关系：比聚合更紧密，如人脑、心脏、等，一挂具挂
- 聚合关系：电脑的各部分
- 继承关系：子承父业

# 十一、Echarts

# 十二、Mongodb

mongod --storageEngine=mmapv1

mongod  dbpath d:\data\db --port 3307

mongod 启动服务器

mongo 	启动客户端

mongod --install -f "E:\mongodb\mongod.conf"

net start mongodb

## 基本概念

- 数据库（database)

- 集合（collection）

- 文档（document）

  - 在mongodb中，数据库和集合都不需要手动创建，当创建文档时，如果文档所在的集合或数据库不存在会自动创建数据库和集合

- | SQL术语/概念 | MongoDB术语/概念 | 解释/说明                           |
  | :----------- | :--------------- | :---------------------------------- |
  | database     | database         | 数据库                              |
  | table        | collection       | 数据库表/集合                       |
  | row          | document         | 数据记录行/文档                     |
  | column       | field            | 数据字段/域                         |
  | index        | index            | 索引                                |
  | table joins  |                  | 表连接,MongoDB不支持                |
  | primary key  | primary key      | 主键,MongoDB自动将_id字段设置为主键 |

| show databases   | 显示当前所有数据库     |
| ---------------- | ---------------------- |
| use 数据库名     | 进入到指定的数据库中   |
| db               | 代表当前所处的数据库   |
| show collections | 显示数据库中所有的集合 |

## CRUD（增删改查）操作

插入文档

- 

# 十三、Scala

# 十四、outlook

# 十五、SPSS

社会科学统计包（Statistical Package for the Social Sciences）

# 十六、Tableau

直方图

- 对要求的分布字段创建数据桶，成列
- 记录数做行

拆分:可以将需要的字符串拆分出来形成一列或多列，命名上不能与元数据字段名重复

- 快速表计算

  <table>
      <tr>
      	<td>ctrl+w</td>
          <td>交换行和列</td>
      </tr>  
      <tr>	
          <td>ctrl+m</td>
          <td>新建工作表</td>
      </tr>
      <tr>
      	<td>alt+shift+backspace</td>
          <td>清除当前工作表</td>
      </tr>
  </table>

## 基本表

- 基本表的使用
- 凸显表的使用

## 树形图

## 气泡图

- (动态气泡图)日期放页面框中

## 词云

- 从气泡图中开始,改为文本

## 标靶图

- 添加参考线

## 甘特图

- 新增日期字段
- 放入大小
- 配色

## 瀑布图4

- 行值改为快速表计算的汇总，即累加模式
- 改为甘特图
- 设置新字段，日期设日期，利润的设利润，向上设正，向下设负，从初始位置开始
- 添加分析中的合计

## 地图6

- 设置地理角色

1. 填充地图
   - 地图中地图层
     - 冲蚀：背景透明度
     - 
2. 多维地图
3. 混合地图
   - 拖拽经纬度再双轴，即可

## 多边形地图7

- 分析中取消聚合度量

## 形状

- 文件defauls中shapes中新建文件夹，添加png格式的图片

## 仪表板

## 数据分层8：

- 创建分层，层级结构
- 创建分组，新字段，共同特性的综合

## 集

满足某些条件的数据子集，它是维度的部分成员

**类型：**

<table>
    <tr>
    	<th>名称</th>
        <th>常量集</th>
        <th>计算集</th>
    </tr>
    <tr>
    	<td>类型</td>
        <td>静态集</td>
        <td>动态集</td>
    </tr>
    <tr>
    	<td>是否会更新</td>
        <td>否</td>
        <td>是</td>
    </tr>
      <tr>
    	<td>可用维度数量</td>
        <td>单个或多个</td>
        <td>单个</td>
    </tr>
      <tr>
    	<td>创建方式</td>
        <td>视图中选择</td>
        <td>数据窗口创建</td>
    </tr>
</table>

**用途:**

1. 集内外成员的对比分析
2. 集内部成员的对比分析
3. 类似于mysql中的连接
4. 可以做分层



# 十七、SAS

# 十八、Fine BI

# 十九、SOFT SKILLS

# 二十、BI理论

# 二十一、MySQL



| 路径   | 解释               | 备注                |
| ------ | ------------------ | ------------------- |
| lib    | 数据库文件存放路径 |                     |
| share  | 配置文件目录       | sever命令及配置文件 |
| bin    | 相关命令目录       | admin/dump等命令    |
| init.d | 启停相关脚本       |                     |

```mysql
show engines
```

| 对比项   | MyISAM                                                   | InnoDB                                                   |
| -------- | -------------------------------------------------------- | -------------------------------------------------------- |
| 主外键   | 不支持                                                   | 支持                                                     |
| 事务     | 不支持                                                   | 支持                                                     |
| 行表锁   | 表锁，即使操作一条记录也会锁住整个表，不适合高并发的操作 | 行锁，操作时只锁某一行，不对其他行有影响，适合高并发操作 |
| 缓存     | 只缓存索引，不缓存真实数据                               | 都缓存，对内存要求较高，其大小对性能有决定性的影响       |
| 表空间   | 小                                                       | 大                                                       |
| 关注点   | 性能                                                     | 事务                                                     |
| 默认安装 | Y                                                        | Y                                                        |

## 索引

是一种数据结构

排好序的快速查找数据结构

在数据之外，数据库系统还维护着满足特定查找算法的数据结构，这些数据结构以某种方式引用（指向）数据

索引本身也很大，不可能全部存储在内存中，因此索引往往以索引文件的形式存储到磁盘上

平常所说的索引，如果没有特别指明，都是指B树（多路搜索树，并不一定是二叉的）结构组织的索引。其中聚集索引、次要索引、覆盖索引、复合索引、前缀索引、唯一索引默认都是使用B+树索引，统称索引。当然，除了B+树这种类型的索引之外，还有哈希索引等

**优势：**

- 类似大学图书馆建书目索引，提高数据检索的效率，降低数据库的IO成本
- 通过索引列对数据进行排序，降低数据排序的成本，降低了CPU的消耗

**劣势：**

- 索引也是表，保存了主键与索引字段，并指向实体表的记录，占用空间
- 麻烦，更新表时，要调整索引信息
- 索引建立要优化调整，麻烦

```mysql
#单值索引
一个表可以有多个
#在user表中为name字段创建索引
create index idx_mytable_name on mytable(name)  
alter mytable add index on(columnName)
drop index on mytable
show index from mytable\G
#复合索引
create index idx_user_nameEmail on user(name, email)  

#唯一索引
索引列的值必须唯一，但允许有空值
```

**创建索引的情况**

1. 主键自动建立唯一索引
2. 频繁作为查询条件的字段应该创建索引
3. 查询中与其他表关联的字段，外键关系建立索引
4. 频繁更新的字段不适合创建索引
5. where条件里用不到的字段不创建索引
6. 在高并发下倾向创建组合索引
7. 查询中排序的字段，排序字段若通过索引去访问将大大提高排序速度
8. 查询中统计或分组字段

**不创建的情况**

1. 数据重复
2. 经常变动
3. 记录少

```mysql
#机读顺序
1 from <left_table>
2 on <join_condition>   #a.id = b.id
3 <join_type> join <right_table>
4 where <where_condition>
5 group by <group_by_list>
6 having <having_condition>
7 select 
8 distinct <select_list>
9 order by <order_by_condition>
10 limit <limit_number>
```

## explain

可以模拟优化器执行SQL查询语句，从而知道MySQL是如何处理你的SQL语句的。分析你的查询语句或是表结构的性能瓶颈

**作用**

explain + SQL语句

- 表的读取顺序
- 数据读取操作的操作类型
- 哪些索引可以使用
- 哪些索引被实际使用
- 表之间的引用
- 每张表有多少行被优化器查询

id相同，从上到下执行

id不同（子查询），id的序号会递增，id值越大优先级越高，越先被执行

| id   | select_type  |              |
| ---- | ------------ | ------------ |
| 1    | simple       |              |
| 2    | primary      | 最外层       |
| 3    | subquery     | 子查询       |
| 4    | derived      | 衍生（临时） |
| 5    | union        |              |
| 6    | union result |              |



# 二十二、Xmind

# 二十三、PS

## 常用分辨率设置

| 洗印照片           | 300或以上 |
| ------------------ | --------- |
| 杂志、名片等印刷物 | 300       |
| 海报高清写真       | 96-200    |
| 网络图片、网页界面 | 72        |
| 大型喷绘           | 25-50     |

## 图片格式

| psd  | ps的原始格式                             |
| ---- | ---------------------------------------- |
| psb  | 更大的ps文件格式，只能由cs或更高版本打开 |
| jpg  | 小巧，常用于互联网传输                   |
| gif  | 支持透明色、动画                         |



## 快捷键

| ctrl+alt+i           | 图像大小          |
| -------------------- | ----------------- |
| 约束比例             | 成比例缩放        |
| alt                  | 复位              |
| alt+shift+ctrl+s     | 存储为web所用格式 |
| ctrl+w               | 关闭文件          |
| ctrl+alt+w           | 关闭全部文件      |
| ctrl+k               | 首选项            |
| ctrl+alt+shift+k     | 快捷键设置        |
| ctrl+shift+n         | 创建新图层        |
| alt+按住眼睛按钮     | 单选指定图层      |
| ctrl+[               | 移动图层位置      |
| ctrl+shift+[         | 移动到顶底        |
| alt+按住图层、ctrl+j | 复制              |
| ctrl+'               | 显示网格          |
| ctrl+1               | 实际像素          |
| 空格键               | 抓手              |
| ctrl+r               | 旋转              |

- 锁链能锁住不同图层，进行对齐，点击其中一个，以该图层位置为主

**选区**

| 按住alt       | 从中心点开始/缩减选区                          |
| ------------- | ---------------------------------------------- |
| 按住shift     | 正方形/增加选区                                |
| shift+alt     | 从中心开始的正方形/交叉选区                    |
| CapsLock      | 聚焦                                           |
| ctrl+d        | 取消选区                                       |
| ctrl+shift+d  | 回到选区                                       |
| ctrl+h        | 隐藏蚂蚁线                                     |
| 羽化/shift+f6 | 选区边缘部分实现过渡式虚化，渐变作用，自然衔接 |
| 样式          | 调节初始选区状态                               |
| 存储选区      |                                                |

**套索**

| ctrl+左键/enter | 连接                      |
| --------------- | ------------------------- |
| alt             | 自由切换                  |
| ctrl+j          | 抠图，复制                |
| ctrl+shift+j    | 剪切的选区生成新图层,分离 |
| 宽度与对比度    |                           |
| 频率            | 出现控点的频率            |
| 选取反向        | 快速截图                  |
| delete          | 去掉选区                  |
| ctrl+delete     | 填充背景色                |
| alt+delete      | 填充前景色                |
| ctrl+alt+r      | 调整边缘                  |
| 选择中的修改    | 边界                      |
| 选择中的收缩    | 能够同比例收缩选区        |

**历史记录**

- ctrl+alt+z		连续撤回

- ctrl+shift+z      前进
- 创建新文档     可以实现备份

**画笔**

| shift+alt+右键   | 选色     |
| ---------------- | -------- |
| alt+右键点击     | 提取颜色 |
| alt+右键按住不放 |          |
| 上下调节硬度     |          |
| 左右调节大小     |          |
| 数字键           | 不透明度 |
| shift+数字键     | 流量     |

**历史画笔**

| ctrl+shift+u | 去色         |
| ------------ | ------------ |
| 艺术画笔     | 模糊画面     |
| A16          | 画笔工具     |
| A17          | 修复画笔工具 |

- 涂抹   alt+右键
- 印章seal  alt+右键
- 仿制源
- 修复画笔工具j     可以跨图，能够融合背景
- 污点修复     去掉画面中的污点
- 修补工具     抹掉不想要的部分并用画面中其他部分替代
- 红眼工具    去除红眼、

**填充**

| shift+删除键 | 填充窗口 |
| ------------ | -------- |

**自由变换**

ctrl+shift+alt+t      复制图片

按住shift旋转时可以显示角度

按住ctrl可以快速按住端点

**通道**

首选区更改通道颜色

ctrl+左键   通道选区

通道中黑色代表透明，白色代表实色区域

alt+添加图层蒙版/点击蒙版   显示不同蒙版状态

ctrl+添加图层蒙版

shift + 点击蒙版     启用或停用

q      快速蒙版

通道中的菜单设置相关属性

图层菜单中选择链接图层一次选取所有链接图层

ctrl+g /alt+点击创建组  创建图层编组

ctrl+shift+g   取消组

shift+点击图层链子    暂时取消该图层连接

|              | 图层连接           | 图层编组           | 智能对象           |
| ------------ | ------------------ | ------------------ | ------------------ |
| 统一移动变换 | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: |
| 统一调整命令 | :no_entry_sign:    | :no_entry_sign:    | :heavy_check_mark: |
| 统一混合模式 | :no_entry_sign:    | :heavy_check_mark: | :heavy_check_mark: |
| 统计叠加次序 | :no_entry_sign:    | :heavy_check_mark: | :heavy_check_mark: |
| 统一施加滤镜 | :no_entry_sign:    | :no_entry_sign:    | :heavy_check_mark: |
| 统一施加蒙版 | :no_entry_sign:    | :heavy_check_mark: | :heavy_check_mark: |
| 统一合并命令 | :no_entry_sign:    | :heavy_check_mark: | :heavy_check_mark: |

# 二十四、数据分析

## 一、观测

**观察**

- 采集数据
  - 解析系统日志
  - 埋点获取新数据
  - 通过传感器采集
  - 爬虫
  - api(application programming interface)应用程序接口,requests
- 存储数据
  - mysql
  - sqlsever
  - hive
  - postgresql
- 展示数据

**测量**

- 设定标准
- 发现异常
- 研究关系

**目的**

- 及时发现异常
- 找到数据之间的因果关系
- 所有未经事实数据验证的想法都是假设

**价值**

- 基于数据反馈不断迭代产品和业务策略
- 基于数据训练算法,让机器自动化地完成工作

**拆解方法**

- 流程拆解法

- 二分法

  - 二分法是所有拆解方法中最简单的，但也是上限最高的一种拆分方法。使用的时候只要注意符合MECE原则就行了。比如，性别维度可以分成男、女，年龄维度可以分成80后、90后。

    二分法的上限在于，当同时使用两种或三种不同的二分法是，基本就是四象限分析。比如，重要不重要和紧急不紧急构成的重要紧急四象限法。

- 公式法

- 象限拆解法

- 杜邦分析法

- SWOT

- RFM

  - 最近一次消费 (Recency)

    消费频率 (Frequency)

    消费金额 (Monetary)

- 5W1H

- PEST

  - PEST分析是指宏观环境的分析，P是政治(politics)，E是经济(economy)，S是社会(society)，T是技术(technology)。在分析一个企业集团所处的背景的时候，通常是通过这四个因素来分析企业集团所面临的状况。

    进行PEST分析需要掌握大量的、充分的相关研究资料，并且对所分析的企业有着深刻的认识，否则，此种分析很难进行下去。经济方面主要内容有经济发展水平、规模、增长率、政府收支、通货膨胀率等。政治方面有政治制度、政府政策、国家的产业政策、相关法律及法规等。社会方面有人口、价值观念、道德水平等。技术方面有高新技术、工艺技术和基础研究的突破性进展。

- AARRR

- MECE分析法，

  - 全称 Mutually Exclusive Collectively Exhaustive，中文意思是"相互独立，完全穷尽"。具体意思是指能够将一个重要的议题分成若干个分类，这些分类之间没有重叠、没有遗漏，并且能够捕捉到问题的核心，并从中得到有效解决问题的方法。

# 二十五、Github

# 二十六、ZODB

# 二十七、HTML、CSS

网站：网页的集合

网页：网站中的一页，通常是HTML格式的文件

网页是网站构成的元素，由图片/链接/文字/声音/视频等元素组成，通常以.htm/.html后缀,俗称HTML文件

**HTML**

超文本标记语言(Hype Text Markup Language),用来描述网页的一种语言

HTML不是编程语言,是标记语言

标记语言是一套标记标签(makeup tag)

<img src=":\敬伟ps教程(精品)\A篇基础入门课程视频\A22\红色衣服2.jpg">

## 超文本

- 它可以加入图片/声音/动画/多媒体等内容(超越了文本限制)
- 可以从一个文件跳转到另一个文件,与世界各地主机的文件连接(超链接文本)

## 浏览器内核

又称渲染引擎:负责读取网页内容,整理讯息,计算网页的显示方式并显示页面

| 浏览器       | 内核    | 备注                 |
| ------------ | ------- | -------------------- |
| IE           | Trident | IE/猎豹/360极速/百度 |
| firefox      | Gecko   | 火狐浏览器内核       |
| Safari       | Webkit  | 苹果内核             |
| chrome/Opera | Blink   | Webkit分支           |

**web标准**

结构/表现/行为相分离

构成:

- 结构:用于对网页元素进行整理和分类,HTML, 结构最重要
- 表现:用于设置网页元素的版式/颜色/大小等外观,即CSS
- 行为:网页模型的定义及交互的编写,javascript

### HTML语法

规范

- 标签是由<>包围的关键词, 一般成对出现

​	```<html></html>```  双标签

​	```<br />```单标签

 - 包含关系

   <head>
       <title></title>
   </head>

 - 并列关系

   ```<head></head>```

   ```<body></body>```

| 标签名          | 定义       | 说明                                                  |
| --------------- | ---------- | ----------------------------------------------------- |
| <html></html>   | HTML标签   | 页面中最大的标签,根标签                               |
| <head></head>   | 文档的头部 | 在head标签中必须要设置的标签是title                   |
| <title></title> | 文档的标题 | 让页面拥有一个属于自己的网页标题                      |
| <body></body>   | 文档的主体 | 元素包含文档的所有内容,页面内容基本都是放到body里面的 |

```HTML
<html>
    <head>
        <title>第一个页面</title>
    </head>
    <body>
        键盘敲烂, 工资过万
    </body>
</html>
```

## vscode

| !                         | 快速生成页面骨架结构    |
| ------------------------- | ----------------------- |
| Prettier - Code formatter | 插件                    |
| auto rename tag           | 插件,自动更改对应的标签 |
| css peek                  | 追踪至样式              |

```<!DOCTYPE html>``` 

- 文档类型声明,告诉浏览器使用哪种HTML版本来显示网页,当前页面采取的是HTML5版本来显示网页
- 是声明标签不是HTML标签

```<html lang="en">```

- en 英语
- zh-CN 中文

``` <meta charset="UTF-8">```

- 字符集

## HTML常用标签

1. **标题标签**

   - ```<h1>-<h6>```
   - 6个等级的网页标题标签

   - ```<h1>我是一级标题</h1>```

   - 一行显示
2. **段落和换行标签**
   
   - ```<p></p>```段落
   - 会根据浏览器窗口的大小自动换行
   - 段落和段落之间保有空隙
   - ```<br/>```换行，单标签，在段落中另起一行
   
3. **文本格式化标签**

   | 加粗   | `<strong>`或者`<b>` | `<strong>`更强烈 |
   | ------ | ------------------- | ---------------- |
   | 倾斜   | `<em>` or` <i>`     | `<em`>better     |
   | 删除线 | `<del>`or `<s>`     | `<del>`better    |
   | 下划线 | `<ins>` or `<u>`    | `<ins>`better    |

4. ```<div>和<span>```

   - 没有语义, 一个盒子,类似于画布,用来装内容
   - div(division)分区
   - span 跨度\跨距

   **特点:**

   - ```<div>```标签用来布局,但是现在一行只能放一个```<div>```,独占一行,大盒子
   - ```<span>```用来布局,一行上可以多个span,小盒子

5. **图像标签和路径**

   - ```<img>```定义图像
     - ```<img src="图像URL"/>```
   - src是```<img>```标签的必须属性,用于指定图像文件的路径和文件名

| 属性   | 属性值   | 说明                               |
| ------ | -------- | ---------------------------------- |
| src    | 图片路径 | 必须属性                           |
| alt    | 文本     | 替换文本,图像不能显示的文字        |
| title  | 文本     | 提示文本,鼠标放到图像上,显示的文字 |
| width  | 像素     | 设置图像的宽度                     |
| height | 像素     | 图像的高度                         |
| border | 像素     | 图像的边框粗细                     |

图像标签属性注意点：

① 图像标签可以拥有多个属性,必须写在标签名的后面

② 属性之间不分先后顺序,标签名与属性,属性与属性之间均已空格分开

③ 属性采取键值对的格式,即key="value"的格式,属性="属性值"

路径：

⑴ 目录文件夹和根目录

目录文件夹：存放相关素材

根目录：打开文件夹的第一层

⑵ 路径分为：

相对路径：以引用文件所在位置为参考，图片相对于HTML页面的位置

| 同一级路径 |      | 图像文件位于HTML同一级，如<img src="baidu.gif />" |
| ---------- | ---- | ------------------------------------------------- |
| 下一级路径 | /    | 位于HTML下一级,如<img src="images/baidu.gif />"   |
| 上一级路径 | ../  | 上一级,如<img src="../baidu.gif />"               |

绝对路径:目录下的绝对位置,直接到达目标位置

例:"D:\web\img\logo.gif" or "https://www.bing.com/images/logo.gif"

6. **超链接标签**

   ```<a>```用于定义超链接,作用是从一个页面链接到另一个页面

   ```<a href="跳转目标" target="目标窗口的弹出方式"> 文本或图像 </a>```

   | 属性   | 作用                                                         |
   | ------ | ------------------------------------------------------------ |
   | href   | 用于指定连接目标的url地址,(必须属性)当为标签应用href属性时,就具有了超链接的功能 |
   | target | 用于指定链接页面的打开方式,其中self为默认值,blank为在新窗口中打开方式 |

   链接分类:

   - **外部链接**,例如```<a href="http://www.baidu.com"> 百度</a>```

   - **内部链接**:网站内部页面之间的相互链接,直接链接内部页面名称即可,如```<a href="index.html"> 首页 </a>```

   - 空链接:没有确定链接目标时,```<a href="#"> 首页</a>```

   - **下载链接**:如果href里面地址是一个文件.exe或者压缩包.zip,会下载这个文件```<a href="img.zip">下载文件</a>```

   - **网页元素链接**:在网页中的各种网页元素,如文本/图像/表格/音频/视频等都可以添加超链接

     ```<a href="http://www.baidu.com" target="_blank"><img src="http://www.baidu.com/images/logo.gif" /></a>```

   - 锚点链接:点击链接,可以快速定位到页面中的某个位置

     - 在链接文本的href属性中,设置属性值为<font color=red>#名字</font>的形式,如```<a href="#two">第二集</a>```
     - 找到目标位置标签,里面添加一个id属性=刚才的名字,如```<h3 id="two">第二集介绍</h3>```

   - 注释

     - `<!-- **** -->  `
     - 快捷键:ctrl+/

   - 特殊字符

   | 特殊字符 | 描述         | 字符代码   |
   | -------- | ------------ | ---------- |
   |          | 空格符       | `&nbsp;`   |
   | <        | 小于号       | `&it;`     |
   | >        | 大于号       | &gt;       |
   | &        | 和号         | &amp;      |
   | ￥       | 人民币       | `&yen;`    |
   | ©        | 版权         | &copy;     |
   | ®        | 注册商标     | &reg;      |
   | °        | 摄氏度       | `&deg;`    |
   | ±        | 正负号       | `&plusmn;` |
   | ×        | 乘号         | &times     |
   | ÷        | 除号         | `&divide;` |
   | ²        | 平方2(上标2) | `&sup2;`   |
   | &sup3;   | 立方3(上标3) | `&sup3;`   |

## 表格标签

不是用来布局页面的,而是用来<font color="red">展示数据的</font>

- `<table></table>`用于定义表格的标签
- `<tr></tr>`行,必须嵌套在table标签中
- `<td></td>`单元格,必须嵌套在tr标签中
- `<th></th>`表头,文字会居中加粗

**表格属性**

实际不常用,用CSS来设置

| 属性名      | 属性值            | 描述                                       |
| ----------- | ----------------- | ------------------------------------------ |
| align       | left,center,right | 对齐方式,`<table align="center">`          |
| border      | 1或""             | 是否有边框,默认""没有,`<table border="1">` |
| cellpadding | 像素值            | 单元边沿与其内容之间的空白,默认1像素       |
| cellspacing | 像素值            | 单元格之间的空白,默认2像素                 |
| width       | 像素值或百分比    | 表格的宽度                                 |
| height      | 像素值或百分比    | 表格的高度                                 |

**表格结构标签**

- `<thead>`表示表格的头部区域,内部必须有`<tr>`标签
- `<tbody>`表示表格的主体区域,主要用于放数据本体
- 都是放在table标签中

**合并单元格**

- 跨行合并:rowspan="合并单元格的个数"
- 跨列合并:colspan="合并单元格的个数"
- 找到/合并/删除多余部分

## 列表标签

用来布局的,标签`<li>`

整齐/整洁/有序

⑴ 无序列表(重点)

- 标签`<ul>`,<font color="red">只能放`<li>`标签</font>,不能在ul标签中输入其他标签或者文字

- `<li>`中可以容纳所有元素

- 自带样式属性

  ```html	
  <ul>
      <li>列表项1</li>
      <li>列表项2</li>
      ...
  </ul>
  ```

⑵ 有序列表

- `<ol>`

  ```html
  <ol>
      <li>列表项1</li>
      <li>列表项2</li>
      ...
  </ol>
  ```

⑶自定义列表

- `<dl>`

  ```html
  <dl>
      <dt>名词1</dt>
      <dd>名词1解释1</dd>
      <dd>名词1解释2</dd>
      ...
  </dl>
  ```

## 表单标签

收集用户信息

⑴ 表单域:包含表单元素的区域

- `<form>`定义表单域,以实现用户信息的收集和传递

  ```html
  <form action="url地址" method="提交方式" name="表单域名称">
      各种表单元素控件
  </form>
  ```

⑵ 表单控件(表单元素)

- `<input>` 单标签, 输入表单元素

- type属性设置不同的属性值用来指定不同的控件类型

  ```html
  <input type="属性值" />
  ```

  | 属性值    | 描述                                                         |
  | --------- | ------------------------------------------------------------ |
  | button    | 点击按钮,结合js搭配使用                                      |
  | checkbox  | 复选框                                                       |
  | file      | 输入字段和浏览按钮,上传文件                                  |
  | hidden    | 隐藏的输入字段                                               |
  | image     | 图像形式的提交按钮                                           |
  | password  | 定义密码字段,该字段中的字符被掩码                            |
  | radio     | 单选按钮                                                     |
  | reset     | 重置按钮,会清除表单中的所有数据                              |
  | submit    | 提交按钮                                                     |
  | text      | 单行的输入字段,默认宽度20个字符                              |
  | name      | 由用户自定义,定义input元素的名称,<font color="red">单选框中尤其要用</font>,复选框中也需要相同name |
  | value     | 由用户自定义,规定input元素的值                               |
  | checked   | 规定此input元素首次加载时应当被选中,如单选框                 |
  | maxlength | 正整数,规定输入字段中的字符的最大长度,如文本框只能输入10字符 |

  `<label>`标签:为input元素定义标注(标签)

  - 用于绑定一个表单元素,当点击`<label>`标签内的文本时,浏览器会自动将焦点(光标)转到或者选择对应的表单元素上,用来增加用户体验

    ```html
    <label for="sex">男</label>
    <input type="radio" name="sex" value="男" id="sex"/>
    ```

- `<select>`下拉表单元素

  ```html
  <select>
      <option>选项1</option>
      <option>选项2</option>
      ...
  </select>
  ```

  1. `<select>`中至少包含一对`<option>`
  2. 在`<option>`中定义selected="selected"时,当前项即为默认选中项

- `<textarea>`文本域元素

  当用户输入内容较多的情况时

  ```html
  <textarea rows="3" cols="20">
  	文本内容
  </textarea>
  ```

⑶ 提示信息

## CSS

- 美化网页,布局页面

- 层叠样式表(Cascading Style Sheets)的简称

- 也称css样式表或级联样式表

- 也是一种标记语言
- 主要用于设置HTML页面中的<font color="red">文本内容</font>(字体/大小/对齐方式等)、图片的外形（宽高、边框样式、边距等）以及<font color="red">版面的布局和外观显示样式</font>

### css语法规范

- 选择器

- 一条或多条声明

  ```html
  <!DOCTYPE html>
  <html lang="en">
  <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>体验CSS语法规范</title>
      <style>
          /* 选择器 {样式} */
          /* 给谁改样式{改什么样式} */
          p {
              color: red;
              font-size: 50px;
          }
      </style>
  </head>
  ```

**CSS代码风格**

1. 样式格式书写
2. 全部用小写
3. 空格规范

**CSS选择器**

- 选择标签用的
- 基础选择器,由单个选择器组成
  - 标签选择器
  - 类选择器
  - id选择器
  - 通配符选择器

| 选择器                                                       | 示例                  | 示例说明                                                   | CSS  |
| :----------------------------------------------------------- | :-------------------- | :--------------------------------------------------------- | :--- |
| [.*class*](https://www.runoob.com/cssref/sel-class.html)     | .intro                | 选择所有class="intro"的元素                                | 1    |
| [#*id*](https://www.runoob.com/cssref/sel-id.html)           | #firstname            | 选择所有id="firstname"的元素                               | 1    |
| [*](https://www.runoob.com/cssref/sel-all.html)              | *                     | 选择所有元素                                               | 2    |
| *[element](https://www.runoob.com/cssref/sel-element.html)*  | p                     | 选择所有<p>元素                                            | 1    |
| *[element,element](https://www.runoob.com/cssref/sel-element-comma.html)* | div,p                 | 选择所有<div>元素和<p>元素                                 | 1    |
| [*element* *element*](https://www.runoob.com/cssref/sel-element-element.html) | div p                 | 选择<div>元素内的所有<p>元素                               | 1    |
| [*element*>*element*](https://www.runoob.com/cssref/sel-element-gt.html) | div>p                 | 选择所有父级是 <div> 元素的 <p> 元素                       | 2    |
| [*element*+*element*](https://www.runoob.com/cssref/sel-element-pluss.html) | div+p                 | 选择所有紧跟在 <div> 元素之后的第一个 <p> 元素             | 2    |
| [[*attribute*\]](https://www.runoob.com/cssref/sel-attribute.html) | [target]              | 选择所有带有target属性元素                                 | 2    |
| [[*attribute*=*value*\]](https://www.runoob.com/cssref/sel-attribute-value.html) | [target=-blank]       | 选择所有使用target="-blank"的元素                          | 2    |
| [[*attribute*~=*value*\]](https://www.runoob.com/cssref/sel-attribute-value-contains.html) | [title~=flower]       | 选择标题属性包含单词"flower"的所有元素                     | 2    |
| [[*attribute*\|=*language*\]](https://www.runoob.com/cssref/sel-attribute-value-lang.html) | [lang\|=en]           | 选择 lang 属性等于 **en**，或者以 **en-** 为开头的所有元素 | 2    |
| [:link](https://www.runoob.com/cssref/sel-link.html)         | a:link                | 选择所有未访问链接                                         | 1    |
| [:visited](https://www.runoob.com/cssref/sel-visited.html)   | a:visited             | 选择所有访问过的链接                                       | 1    |
| [:active](https://www.runoob.com/cssref/sel-active.html)     | a:active              | 选择活动链接                                               | 1    |
| [:hover](https://www.runoob.com/cssref/sel-hover.html)       | a:hover               | 选择鼠标在链接上面时                                       | 1    |
| [:focus](https://www.runoob.com/cssref/sel-focus.html)       | input:focus           | 选择具有焦点的输入元素                                     | 2    |
| [:first-letter](https://www.runoob.com/cssref/sel-firstletter.html) | p:first-letter        | 选择每一个<p>元素的第一个字母                              | 1    |
| [:first-line](https://www.runoob.com/cssref/sel-firstline.html) | p:first-line          | 选择每一个<p>元素的第一行                                  | 1    |
| [:first-child](https://www.runoob.com/cssref/sel-firstchild.html) | p:first-child         | 指定只有当<p>元素是其父级的第一个子级的样式。              | 2    |
| [:before](https://www.runoob.com/cssref/sel-before.html)     | p:before              | 在每个<p>元素之前插入内容                                  | 2    |
| [:after](https://www.runoob.com/cssref/sel-after.html)       | p:after               | 在每个<p>元素之后插入内容                                  | 2    |
| [:lang(*language*)](https://www.runoob.com/cssref/sel-lang.html) | p:lang(it)            | 选择一个lang属性的起始值="it"的所有<p>元素                 | 2    |
| [*element1*~*element2*](https://www.runoob.com/cssref/sel-gen-sibling.html) | p~ul                  | 选择p元素之后的每一个ul元素                                | 3    |
| [[*attribute*^=*value*\]](https://www.runoob.com/cssref/sel-attr-begin.html) | a[src^="https"]       | 选择每一个src属性的值以"https"开头的元素                   | 3    |
| [[*attribute*$=*value*\]](https://www.runoob.com/cssref/sel-attr-end.html) | a[src$=".pdf"]        | 选择每一个src属性的值以".pdf"结尾的元素                    | 3    |
| [[*attribute**=*value*\]](https://www.runoob.com/cssref/sel-attr-contain.html) | a[src*="runoob"]      | 选择每一个src属性的值包含子字符串"runoob"的元素            | 3    |
| [:first-of-type](https://www.runoob.com/cssref/sel-first-of-type.html) | p:first-of-type       | 选择每个p元素是其父级的第一个p元素                         | 3    |
| [:last-of-type](https://www.runoob.com/cssref/sel-last-of-type.html) | p:last-of-type        | 选择每个p元素是其父级的最后一个p元素                       | 3    |
| [:only-of-type](https://www.runoob.com/cssref/sel-only-of-type.html) | p:only-of-type        | 选择每个p元素是其父级的唯一p元素                           | 3    |
| [:only-child](https://www.runoob.com/cssref/sel-only-child.html) | p:only-child          | 选择每个p元素是其父级的唯一子元素                          | 3    |
| [:nth-child(*n*)](https://www.runoob.com/cssref/sel-nth-child.html) | p:nth-child(2)        | 选择每个p元素是其父级的第二个子元素                        | 3    |
| [:nth-last-child(*n*)](https://www.runoob.com/cssref/sel-nth-last-child.html) | p:nth-last-child(2)   | 选择每个p元素的是其父级的第二个子元素，从最后一个子项计数  | 3    |
| [:nth-of-type(*n*)](https://www.runoob.com/cssref/sel-nth-of-type.html) | p:nth-of-type(2)      | 选择每个p元素是其父级的第二个p元素                         | 3    |
| [:nth-last-of-type(*n*)](https://www.runoob.com/cssref/sel-nth-last-of-type.html) | p:nth-last-of-type(2) | 选择每个p元素的是其父级的第二个p元素，从最后一个子项计数   | 3    |
| [:last-child](https://www.runoob.com/cssref/sel-last-child.html) | p:last-child          | 选择每个p元素是其父级的最后一个子级。                      | 3    |
| [:root](https://www.runoob.com/cssref/sel-root.html)         | :root                 | 选择文档的根元素                                           | 3    |
| [:empty](https://www.runoob.com/cssref/sel-empty.html)       | p:empty               | 选择每个没有任何子级的p元素（包括文本节点）                | 3    |
| [:target](https://www.runoob.com/cssref/sel-target.html)     | #news:target          | 选择当前活动的#news元素（包含该锚名称的点击的URL）         | 3    |
| [:enabled](https://www.runoob.com/cssref/sel-enabled.html)   | input:enabled         | 选择每一个已启用的输入元素                                 | 3    |
| [:disabled](https://www.runoob.com/cssref/sel-disabled.html) | input:disabled        | 选择每一个禁用的输入元素                                   | 3    |
| [:checked](https://www.runoob.com/cssref/sel-checked.html)   | input:checked         | 选择每个选中的输入元素                                     | 3    |
| [:not(*selector*)](https://www.runoob.com/cssref/sel-not.html) | :not(p)               | 选择每个并非p元素的元素                                    | 3    |
| [::selection](https://www.runoob.com/cssref/sel-selection.html) | ::selection           | 匹配元素中被用户选中或处于高亮状态的部分                   | 3    |
| [:out-of-range](https://www.runoob.com/cssref/sel-out-of-range.html) | :out-of-range         | 匹配值在指定区间之外的input元素                            | 3    |
| [:in-range](https://www.runoob.com/cssref/sel-in-range.html) | :in-range             | 匹配值在指定区间之内的input元素                            | 3    |
| [:read-write](https://www.runoob.com/cssref/sel-read-write.html) | :read-write           | 用于匹配可读及可写的元素                                   | 3    |
| [:read-only](https://www.runoob.com/cssref/sel-read-only.html) | :read-only            | 用于匹配设置 "readonly"（只读） 属性的元素                 | 3    |
| [:optional](https://www.runoob.com/cssref/sel-optional.html) | :optional             | 用于匹配可选的输入元素                                     | 3    |
| [:required](https://www.runoob.com/cssref/sel-required.html) | :required             | 用于匹配设置了 "required" 属性的元素                       | 3    |
| [:valid](https://www.runoob.com/cssref/sel-valid.html)       | :valid                | 用于匹配输入值为合法的元素                                 | 3    |
| [:invalid](https://www.runoob.com/cssref/sel-invalid.html)   | :invalid              | 用于匹配输入值为非法的元素                                 | 3    |
